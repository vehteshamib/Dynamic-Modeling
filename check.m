function checking_values = check(t,z)

global ms mp mf Ixx Iyy Izz Ixy Ixz Iyz a b c h l ks gamas

X = z(:,1); Y = z(:,2); Z = z(:,3); q1 = z(:,4); q2 = z(:,5); q3 = z(:,6);
gama1 = z(:,7); gama2 = z(:,8); b1 = z(:,9); b2 = z(:,10);
dX = z(:,11); dY = z(:,12); dZ = z(:,13); dq1 = z(:,14); dq2 = z(:,15); dq3 = z(:,16);
dgama1 = z(:,17); dgama2 = z(:,18); db1 = z(:,19); db2 = z(:,20);

Size=size(t);

for i=1:Size
    E(i) =(mp*(b*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) + 2*dX(i)*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) - 2*dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) + b*cos(gama1(i))*(dgama1(i) - dq2(i)*sin(q3(i)) + dq1(i)*cos(q2(i))*cos(q3(i))) - 2*dZ(i)*cos(q2(i))*sin(q3(i)))^2)/8 + (mf*(dX(i)*cos(q1(i))*cos(q2(i)) - dq2(i)*h*sin(q3(i)) - dZ(i)*sin(q2(i)) + dY(i)*cos(q2(i))*sin(q1(i)) - db2(i)*l*cos(b2(i)) + dq1(i)*h*cos(q2(i))*cos(q3(i)) + dq2(i)*l*cos(b1(i))*cos(b2(i))*sin(q3(i)) + dq2(i)*l*cos(b2(i))*cos(q3(i))*sin(b1(i)) - dq1(i)*l*cos(b1(i))*cos(b2(i))*cos(q2(i))*cos(q3(i)) + dq1(i)*l*cos(b2(i))*cos(q2(i))*sin(b1(i))*sin(q3(i)))^2)/2 + (mp*(2*dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) - b*dq2(i)*sin(q3(i)) + b*cos(gama2(i))*(dgama2(i) + dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - 2*dX(i)*cos(q3(i))*sin(q1(i)) + 2*dZ(i)*cos(q2(i))*sin(q3(i)) + 2*dX(i)*cos(q1(i))*sin(q2(i))*sin(q3(i)) + b*dq1(i)*cos(q2(i))*cos(q3(i)))^2)/8 + (mp*(2*dX(i)*cos(q1(i))*cos(q2(i)) - a*dq2(i)*sin(q3(i)) - 2*dZ(i)*sin(q2(i)) + b*sin(gama1(i))*(dgama1(i) - dq2(i)*sin(q3(i)) + dq1(i)*cos(q2(i))*cos(q3(i))) + 2*dY(i)*cos(q2(i))*sin(q1(i)) + a*dq1(i)*cos(q2(i))*cos(q3(i)))^2)/8 + (mp*(a*(dq3(i) - dq1(i)*sin(q2(i))) - b*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + 2*dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) + b*cos(gama2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + b*sin(gama2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + 2*dZ(i)*cos(q2(i))*cos(q3(i)) - 2*dY(i)*cos(q1(i))*sin(q3(i)) + 2*dY(i)*cos(q3(i))*sin(q1(i))*sin(q2(i)))^2)/8 + ((dq2(i)*cos(q3(i)))/2 + (dq1(i)*cos(q2(i))*sin(q3(i)))/2)*(Iyy*dq2(i)*cos(q3(i)) - Ixy*dq3(i) + Ixy*dq1(i)*sin(q2(i)) + Iyz*dq2(i)*sin(q3(i)) - Iyz*dq1(i)*cos(q2(i))*cos(q3(i)) + Iyy*dq1(i)*cos(q2(i))*sin(q3(i))) + ((dq2(i)*sin(q3(i)))/2 - (dq1(i)*cos(q2(i))*cos(q3(i)))/2)*(Ixz*dq3(i) + Iyz*dq2(i)*cos(q3(i)) - Ixz*dq1(i)*sin(q2(i)) + Izz*dq2(i)*sin(q3(i)) - Izz*dq1(i)*cos(q2(i))*cos(q3(i)) + Iyz*dq1(i)*cos(q2(i))*sin(q3(i))) + (dX(i)^2*ms)/2 + (dY(i)^2*ms)/2 + (dZ(i)^2*ms)/2 + (mf*(dY(i)*cos(q1(i))*cos(q3(i)) - db1(i)*l*sin(b1(i)) - dX(i)*cos(q3(i))*sin(q1(i)) + dZ(i)*cos(q2(i))*sin(q3(i)) + dX(i)*cos(q1(i))*sin(q2(i))*sin(q3(i)) + dY(i)*sin(q1(i))*sin(q2(i))*sin(q3(i)) - db2(i)*l*cos(b1(i))*sin(b2(i)) - dq3(i)*l*cos(b2(i))*sin(b1(i)) + dq2(i)*l*sin(b2(i))*sin(q3(i)) - dq1(i)*l*cos(q2(i))*cos(q3(i))*sin(b2(i)) + dq1(i)*l*cos(b2(i))*sin(b1(i))*sin(q2(i)))^2)/2 + (mf*(dq1(i)*h*sin(q2(i)) - dq3(i)*h + dZ(i)*cos(q2(i))*cos(q3(i)) - dY(i)*cos(q1(i))*sin(q3(i)) + dX(i)*sin(q1(i))*sin(q3(i)) + db1(i)*l*cos(b1(i)) + dX(i)*cos(q1(i))*cos(q3(i))*sin(q2(i)) + dY(i)*cos(q3(i))*sin(q1(i))*sin(q2(i)) + dq3(i)*l*cos(b1(i))*cos(b2(i)) + dq2(i)*l*cos(q3(i))*sin(b2(i)) - db2(i)*l*sin(b1(i))*sin(b2(i)) - dq1(i)*l*cos(b1(i))*cos(b2(i))*sin(q2(i)) + dq1(i)*l*cos(q2(i))*sin(b2(i))*sin(q3(i)))^2)/2 + (ks*(gama1(i) - gamas)^2)/2 + (ks*(gama2(i) - gamas)^2)/2 + (mp*(a*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - 2*dZ(i)*sin(q2(i)) + 2*dX(i)*cos(q1(i))*cos(q2(i)) + b*sin(gama2(i))*(dgama2(i) + dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) + 2*dY(i)*cos(q2(i))*sin(q1(i)))^2)/8 + (mp*(a*(dq3(i) - dq1(i)*sin(q2(i))) + b*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - 2*dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) + 2*dY(i)*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i))) - b*cos(gama1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + b*sin(gama1(i))*(dq3(i) - dq1(i)*sin(q2(i))) - 2*dZ(i)*cos(q2(i))*cos(q3(i)))^2)/8 - (dq3(i)/2 - (dq1(i)*sin(q2(i)))/2)*(Ixy*dq2(i)*cos(q3(i)) - Ixx*dq3(i) + Ixx*dq1(i)*sin(q2(i)) - Ixz*dq2(i)*sin(q3(i)) + Ixz*dq1(i)*cos(q2(i))*cos(q3(i)) + Ixy*dq1(i)*cos(q2(i))*sin(q3(i))) + (mp*((cos(gama1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 - (sin(gama1(i))*(dq3(i) - dq1(i)*sin(q2(i))))/2)*(b^2 + c^2)*(dq2(i)*cos(gama1(i))*cos(q3(i)) - dq3(i)*sin(gama1(i)) + dq1(i)*sin(gama1(i))*sin(q2(i)) + dq1(i)*cos(gama1(i))*cos(q2(i))*sin(q3(i))))/12 + (b^2*mp*(dgama1(i)/2 - (dq2(i)*sin(q3(i)))/2 + (dq1(i)*cos(q2(i))*cos(q3(i)))/2)*(dgama1(i) - dq2(i)*sin(q3(i)) + dq1(i)*cos(q2(i))*cos(q3(i))))/12 + (b^2*mp*(dgama2(i)/2 + (dq2(i)*sin(q3(i)))/2 - (dq1(i)*cos(q2(i))*cos(q3(i)))/2)*(dgama2(i) + dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/12 + (c^2*mp*(cos(gama1(i))*(dq3(i) - dq1(i)*sin(q2(i))) + sin(gama1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))*((cos(gama1(i))*(dq3(i) - dq1(i)*sin(q2(i))))/2 + (sin(gama1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2))/12 + (c^2*mp*(cos(gama2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - sin(gama2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))*((cos(gama2(i))*(dq3(i) - dq1(i)*sin(q2(i))))/2 - (sin(gama2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2))/12 + (mp*(cos(gama2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + sin(gama2(i))*(dq3(i) - dq1(i)*sin(q2(i))))*((cos(gama2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 + (sin(gama2(i))*(dq3(i) - dq1(i)*sin(q2(i))))/2)*(b^2 + c^2))/12;
    E_error(i)=(E(i)-E(1))/E(1)*100;
    
    PX(i)=dX(i)*mf + 2*dX(i)*mp + dX(i)*ms + dq1(i)*h*mf*cos(q1(i))*cos(q3(i)) - b*dq1(i)*mp*cos(q2(i))*sin(q1(i)) - b*dq2(i)*mp*cos(q1(i))*sin(q2(i)) - dq3(i)*h*mf*sin(q1(i))*sin(q3(i)) - db2(i)*l*mf*cos(b2(i))*cos(q1(i))*cos(q2(i)) + (b*dgama1(i)*mp*cos(q1(i))*cos(q2(i))*sin(gama1(i)))/2 + (b*dgama1(i)*mp*cos(gama1(i))*cos(q3(i))*sin(q1(i)))/2 + (b*dgama2(i)*mp*cos(q1(i))*cos(q2(i))*sin(gama2(i)))/2 - (b*dgama2(i)*mp*cos(gama2(i))*cos(q3(i))*sin(q1(i)))/2 + (b*dq1(i)*mp*cos(gama1(i))*cos(q2(i))*sin(q1(i)))/2 + (b*dq1(i)*mp*cos(gama2(i))*cos(q2(i))*sin(q1(i)))/2 + (b*dq1(i)*mp*cos(q1(i))*cos(q3(i))*sin(gama1(i)))/2 + (b*dq2(i)*mp*cos(gama1(i))*cos(q1(i))*sin(q2(i)))/2 - (b*dq1(i)*mp*cos(q1(i))*cos(q3(i))*sin(gama2(i)))/2 + (b*dq2(i)*mp*cos(gama2(i))*cos(q1(i))*sin(q2(i)))/2 - dq2(i)*h*mf*cos(q1(i))*cos(q2(i))*sin(q3(i)) - dq3(i)*h*mf*cos(q1(i))*cos(q3(i))*sin(q2(i)) + db1(i)*l*mf*cos(b1(i))*sin(q1(i))*sin(q3(i)) + db1(i)*l*mf*cos(q3(i))*sin(b1(i))*sin(q1(i)) + dq1(i)*l*mf*cos(q2(i))*sin(b2(i))*sin(q1(i)) + dq2(i)*l*mf*cos(q1(i))*sin(b2(i))*sin(q2(i)) - (b*dq3(i)*mp*sin(gama1(i))*sin(q1(i))*sin(q3(i)))/2 + (b*dq3(i)*mp*sin(gama2(i))*sin(q1(i))*sin(q3(i)))/2 + dq1(i)*h*mf*sin(q1(i))*sin(q2(i))*sin(q3(i)) - db1(i)*l*mf*cos(q1(i))*sin(b1(i))*sin(q2(i))*sin(q3(i)) - db2(i)*l*mf*sin(b1(i))*sin(b2(i))*sin(q1(i))*sin(q3(i)) + (b*dq1(i)*mp*sin(gama1(i))*sin(q1(i))*sin(q2(i))*sin(q3(i)))/2 - (b*dq1(i)*mp*sin(gama2(i))*sin(q1(i))*sin(q2(i))*sin(q3(i)))/2 - dq1(i)*l*mf*cos(b1(i))*cos(b2(i))*cos(q1(i))*cos(q3(i)) + db1(i)*l*mf*cos(b1(i))*cos(q1(i))*cos(q3(i))*sin(q2(i)) + db2(i)*l*mf*cos(b1(i))*cos(q3(i))*sin(b2(i))*sin(q1(i)) + dq1(i)*l*mf*cos(b2(i))*cos(q1(i))*sin(b1(i))*sin(q3(i)) + dq3(i)*l*mf*cos(b1(i))*cos(b2(i))*sin(q1(i))*sin(q3(i)) + dq3(i)*l*mf*cos(b2(i))*cos(q3(i))*sin(b1(i))*sin(q1(i)) - (b*dgama1(i)*mp*cos(gama1(i))*cos(q1(i))*sin(q2(i))*sin(q3(i)))/2 + (b*dgama2(i)*mp*cos(gama2(i))*cos(q1(i))*sin(q2(i))*sin(q3(i)))/2 - (b*dq2(i)*mp*cos(q1(i))*cos(q2(i))*sin(gama1(i))*sin(q3(i)))/2 + (b*dq2(i)*mp*cos(q1(i))*cos(q2(i))*sin(gama2(i))*sin(q3(i)))/2 - (b*dq3(i)*mp*cos(q1(i))*cos(q3(i))*sin(gama1(i))*sin(q2(i)))/2 + (b*dq3(i)*mp*cos(q1(i))*cos(q3(i))*sin(gama2(i))*sin(q2(i)))/2 + dq2(i)*l*mf*cos(b1(i))*cos(b2(i))*cos(q1(i))*cos(q2(i))*sin(q3(i)) + dq2(i)*l*mf*cos(b2(i))*cos(q1(i))*cos(q2(i))*cos(q3(i))*sin(b1(i)) + dq3(i)*l*mf*cos(b1(i))*cos(b2(i))*cos(q1(i))*cos(q3(i))*sin(q2(i)) - db2(i)*l*mf*cos(b1(i))*cos(q1(i))*sin(b2(i))*sin(q2(i))*sin(q3(i)) - db2(i)*l*mf*cos(q1(i))*cos(q3(i))*sin(b1(i))*sin(b2(i))*sin(q2(i)) - dq1(i)*l*mf*cos(b1(i))*cos(b2(i))*sin(q1(i))*sin(q2(i))*sin(q3(i)) - dq1(i)*l*mf*cos(b2(i))*cos(q3(i))*sin(b1(i))*sin(q1(i))*sin(q2(i)) - dq3(i)*l*mf*cos(b2(i))*cos(q1(i))*sin(b1(i))*sin(q2(i))*sin(q3(i));
    PY(i)=dY(i)*mf + 2*dY(i)*mp + dY(i)*ms + b*dq1(i)*mp*cos(q1(i))*cos(q2(i)) + dq1(i)*h*mf*cos(q3(i))*sin(q1(i)) + dq3(i)*h*mf*cos(q1(i))*sin(q3(i)) - b*dq2(i)*mp*sin(q1(i))*sin(q2(i)) - (b*dgama1(i)*mp*cos(gama1(i))*cos(q1(i))*cos(q3(i)))/2 + (b*dgama2(i)*mp*cos(gama2(i))*cos(q1(i))*cos(q3(i)))/2 - (b*dq1(i)*mp*cos(gama1(i))*cos(q1(i))*cos(q2(i)))/2 - (b*dq1(i)*mp*cos(gama2(i))*cos(q1(i))*cos(q2(i)))/2 - db1(i)*l*mf*cos(b1(i))*cos(q1(i))*sin(q3(i)) - db1(i)*l*mf*cos(q1(i))*cos(q3(i))*sin(b1(i)) - db2(i)*l*mf*cos(b2(i))*cos(q2(i))*sin(q1(i)) - dq1(i)*l*mf*cos(q1(i))*cos(q2(i))*sin(b2(i)) + (b*dgama1(i)*mp*cos(q2(i))*sin(gama1(i))*sin(q1(i)))/2 + (b*dgama2(i)*mp*cos(q2(i))*sin(gama2(i))*sin(q1(i)))/2 + (b*dq1(i)*mp*cos(q3(i))*sin(gama1(i))*sin(q1(i)))/2 + (b*dq2(i)*mp*cos(gama1(i))*sin(q1(i))*sin(q2(i)))/2 - (b*dq1(i)*mp*cos(q3(i))*sin(gama2(i))*sin(q1(i)))/2 + (b*dq2(i)*mp*cos(gama2(i))*sin(q1(i))*sin(q2(i)))/2 + (b*dq3(i)*mp*cos(q1(i))*sin(gama1(i))*sin(q3(i)))/2 - (b*dq3(i)*mp*cos(q1(i))*sin(gama2(i))*sin(q3(i)))/2 - dq1(i)*h*mf*cos(q1(i))*sin(q2(i))*sin(q3(i)) - dq2(i)*h*mf*cos(q2(i))*sin(q1(i))*sin(q3(i)) - dq3(i)*h*mf*cos(q3(i))*sin(q1(i))*sin(q2(i)) + dq2(i)*l*mf*sin(b2(i))*sin(q1(i))*sin(q2(i)) + db2(i)*l*mf*cos(q1(i))*sin(b1(i))*sin(b2(i))*sin(q3(i)) + dq1(i)*l*mf*cos(b2(i))*sin(b1(i))*sin(q1(i))*sin(q3(i)) - (b*dgama1(i)*mp*cos(gama1(i))*sin(q1(i))*sin(q2(i))*sin(q3(i)))/2 + (b*dgama2(i)*mp*cos(gama2(i))*sin(q1(i))*sin(q2(i))*sin(q3(i)))/2 - (b*dq1(i)*mp*cos(q1(i))*sin(gama1(i))*sin(q2(i))*sin(q3(i)))/2 + (b*dq1(i)*mp*cos(q1(i))*sin(gama2(i))*sin(q2(i))*sin(q3(i)))/2 - (b*dq2(i)*mp*cos(q2(i))*sin(gama1(i))*sin(q1(i))*sin(q3(i)))/2 + (b*dq2(i)*mp*cos(q2(i))*sin(gama2(i))*sin(q1(i))*sin(q3(i)))/2 - (b*dq3(i)*mp*cos(q3(i))*sin(gama1(i))*sin(q1(i))*sin(q2(i)))/2 + (b*dq3(i)*mp*cos(q3(i))*sin(gama2(i))*sin(q1(i))*sin(q2(i)))/2 - db1(i)*l*mf*sin(b1(i))*sin(q1(i))*sin(q2(i))*sin(q3(i)) - db2(i)*l*mf*cos(b1(i))*cos(q1(i))*cos(q3(i))*sin(b2(i)) - dq1(i)*l*mf*cos(b1(i))*cos(b2(i))*cos(q3(i))*sin(q1(i)) - dq3(i)*l*mf*cos(b1(i))*cos(b2(i))*cos(q1(i))*sin(q3(i)) - dq3(i)*l*mf*cos(b2(i))*cos(q1(i))*cos(q3(i))*sin(b1(i)) + db1(i)*l*mf*cos(b1(i))*cos(q3(i))*sin(q1(i))*sin(q2(i)) + dq1(i)*l*mf*cos(b1(i))*cos(b2(i))*cos(q1(i))*sin(q2(i))*sin(q3(i)) + dq1(i)*l*mf*cos(b2(i))*cos(q1(i))*cos(q3(i))*sin(b1(i))*sin(q2(i)) + dq2(i)*l*mf*cos(b1(i))*cos(b2(i))*cos(q2(i))*sin(q1(i))*sin(q3(i)) + dq2(i)*l*mf*cos(b2(i))*cos(q2(i))*cos(q3(i))*sin(b1(i))*sin(q1(i)) + dq3(i)*l*mf*cos(b1(i))*cos(b2(i))*cos(q3(i))*sin(q1(i))*sin(q2(i)) - db2(i)*l*mf*cos(b1(i))*sin(b2(i))*sin(q1(i))*sin(q2(i))*sin(q3(i)) - db2(i)*l*mf*cos(q3(i))*sin(b1(i))*sin(b2(i))*sin(q1(i))*sin(q2(i)) - dq3(i)*l*mf*cos(b2(i))*sin(b1(i))*sin(q1(i))*sin(q2(i))*sin(q3(i));
    PZ(i)=dZ(i)*mf + 2*dZ(i)*mp + dZ(i)*ms - b*dq2(i)*mp*cos(q2(i)) + (b*dq2(i)*mp*cos(gama1(i))*cos(q2(i)))/2 + (b*dq2(i)*mp*cos(gama2(i))*cos(q2(i)))/2 - dq3(i)*h*mf*cos(q2(i))*cos(q3(i)) + db2(i)*l*mf*cos(b2(i))*sin(q2(i)) + dq2(i)*l*mf*cos(q2(i))*sin(b2(i)) - (b*dgama1(i)*mp*sin(gama1(i))*sin(q2(i)))/2 - (b*dgama2(i)*mp*sin(gama2(i))*sin(q2(i)))/2 + dq2(i)*h*mf*sin(q2(i))*sin(q3(i)) + db1(i)*l*mf*cos(b1(i))*cos(q2(i))*cos(q3(i)) - (b*dgama1(i)*mp*cos(gama1(i))*cos(q2(i))*sin(q3(i)))/2 + (b*dgama2(i)*mp*cos(gama2(i))*cos(q2(i))*sin(q3(i)))/2 - (b*dq3(i)*mp*cos(q2(i))*cos(q3(i))*sin(gama1(i)))/2 + (b*dq3(i)*mp*cos(q2(i))*cos(q3(i))*sin(gama2(i)))/2 - db1(i)*l*mf*cos(q2(i))*sin(b1(i))*sin(q3(i)) + (b*dq2(i)*mp*sin(gama1(i))*sin(q2(i))*sin(q3(i)))/2 - (b*dq2(i)*mp*sin(gama2(i))*sin(q2(i))*sin(q3(i)))/2 + dq3(i)*l*mf*cos(b1(i))*cos(b2(i))*cos(q2(i))*cos(q3(i)) - db2(i)*l*mf*cos(b1(i))*cos(q2(i))*sin(b2(i))*sin(q3(i)) - db2(i)*l*mf*cos(q2(i))*cos(q3(i))*sin(b1(i))*sin(b2(i)) - dq2(i)*l*mf*cos(b1(i))*cos(b2(i))*sin(q2(i))*sin(q3(i)) - dq2(i)*l*mf*cos(b2(i))*cos(q3(i))*sin(b1(i))*sin(q2(i)) - dq3(i)*l*mf*cos(b2(i))*cos(q2(i))*sin(b1(i))*sin(q3(i));
    PX_error(i)=(PX(i)-PX(1))/PX(1)*100;
    PY_error(i)=(PY(i)-PY(1))/PY(1)*100;
    PZ_error(i)=(PZ(i)-PZ(1))/PZ(1)*100;
    
    HX(i)=(Y(i) + (cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i)))*(a/2 + (b*sin(gama2(i)))/2) + cos(q2(i))*sin(q1(i))*(b/2 - (b*cos(gama2(i)))/2))*(mp*cos(q2(i))*cos(q3(i))*((a*(dq3(i) - dq1(i)*sin(q2(i))))/2 - (b*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 + dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) - dY(i)*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i))) + (b*cos(gama2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 + (b*sin(gama2(i))*(dq3(i) - dq1(i)*sin(q2(i))))/2 + dZ(i)*cos(q2(i))*cos(q3(i))) - mp*sin(q2(i))*((a*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 - dZ(i)*sin(q2(i)) + dX(i)*cos(q1(i))*cos(q2(i)) + (b*sin(gama2(i))*(dgama2(i) + dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dY(i)*cos(q2(i))*sin(q1(i))) + mp*cos(q2(i))*sin(q3(i))*(dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) - dX(i)*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) - (b*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + (b*cos(gama2(i))*(dgama2(i) + dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dZ(i)*cos(q2(i))*sin(q3(i)))) - (Z(i) - sin(q2(i))*(b/2 - (b*cos(gama2(i)))/2) + cos(q2(i))*sin(q3(i))*(a/2 + (b*sin(gama2(i)))/2))*(mp*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i)))*(dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) - dX(i)*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) - (b*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + (b*cos(gama2(i))*(dgama2(i) + dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dZ(i)*cos(q2(i))*sin(q3(i))) - mp*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i)))*((a*(dq3(i) - dq1(i)*sin(q2(i))))/2 - (b*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 + dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) - dY(i)*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i))) + (b*cos(gama2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 + (b*sin(gama2(i))*(dq3(i) - dq1(i)*sin(q2(i))))/2 + dZ(i)*cos(q2(i))*cos(q3(i))) + mp*cos(q2(i))*sin(q1(i))*((a*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 - dZ(i)*sin(q2(i)) + dX(i)*cos(q1(i))*cos(q2(i)) + (b*sin(gama2(i))*(dgama2(i) + dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dY(i)*cos(q2(i))*sin(q1(i)))) - (cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i)))*(Iyy*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - Ixy*(dq3(i) - dq1(i)*sin(q2(i))) + Iyz*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) - (sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i)))*(Ixz*(dq3(i) - dq1(i)*sin(q2(i))) + Iyz*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + Izz*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) - (Y(i) - (cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i)))*(a/2 + (b*sin(gama1(i)))/2) + cos(q2(i))*sin(q1(i))*(b/2 - (b*cos(gama1(i)))/2))*(mp*sin(q2(i))*(dX(i)*cos(q1(i))*cos(q2(i)) - dZ(i)*sin(q2(i)) - (a*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + (b*sin(gama1(i))*(dgama1(i) - dq2(i)*sin(q3(i)) + dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dY(i)*cos(q2(i))*sin(q1(i))) + mp*cos(q2(i))*cos(q3(i))*((a*(dq3(i) - dq1(i)*sin(q2(i))))/2 + (b*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 - dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) + dY(i)*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i))) - (b*cos(gama1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 + (b*sin(gama1(i))*(dq3(i) - dq1(i)*sin(q2(i))))/2 - dZ(i)*cos(q2(i))*cos(q3(i))) + mp*cos(q2(i))*sin(q3(i))*((b*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dX(i)*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) - dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) + (b*cos(gama1(i))*(dgama1(i) - dq2(i)*sin(q3(i)) + dq1(i)*cos(q2(i))*cos(q3(i))))/2 - dZ(i)*cos(q2(i))*sin(q3(i)))) - (mf*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i)))*(dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) - dX(i)*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) + dZ(i)*cos(q2(i))*sin(q3(i)) + l*sin(b2(i))*(cos(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) - sin(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*sin(b1(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))) - l*cos(b2(i))*sin(b1(i))*(sin(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))))) - mf*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i)))*(dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) - h*(dq3(i) - dq1(i)*sin(q2(i))) - dY(i)*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i))) + dZ(i)*cos(q2(i))*cos(q3(i)) + l*sin(b2(i))*(sin(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) + cos(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) - cos(b1(i))*cos(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))) + l*cos(b1(i))*cos(b2(i))*(sin(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))))) + mf*cos(q2(i))*sin(q1(i))*(dX(i)*cos(q1(i))*cos(q2(i)) - dZ(i)*sin(q2(i)) - h*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) + dY(i)*cos(q2(i))*sin(q1(i)) + l*cos(b1(i))*cos(b2(i))*(cos(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) - sin(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*sin(b1(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))) + l*cos(b2(i))*sin(b1(i))*(sin(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) + cos(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) - cos(b1(i))*cos(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))))))*(Z(i) - cos(q2(i))*sin(q3(i))*(h - l*cos(b1(i))*cos(b2(i))) + l*sin(b2(i))*sin(q2(i)) + l*cos(b2(i))*cos(q2(i))*cos(q3(i))*sin(b1(i))) - (mf*cos(q2(i))*cos(q3(i))*(dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) - h*(dq3(i) - dq1(i)*sin(q2(i))) - dY(i)*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i))) + dZ(i)*cos(q2(i))*cos(q3(i)) + l*sin(b2(i))*(sin(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) + cos(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) - cos(b1(i))*cos(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))) + l*cos(b1(i))*cos(b2(i))*(sin(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))))) - mf*sin(q2(i))*(dX(i)*cos(q1(i))*cos(q2(i)) - dZ(i)*sin(q2(i)) - h*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) + dY(i)*cos(q2(i))*sin(q1(i)) + l*cos(b1(i))*cos(b2(i))*(cos(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) - sin(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*sin(b1(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))) + l*cos(b2(i))*sin(b1(i))*(sin(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) + cos(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) - cos(b1(i))*cos(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))))) + mf*cos(q2(i))*sin(q3(i))*(dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) - dX(i)*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) + dZ(i)*cos(q2(i))*sin(q3(i)) + l*sin(b2(i))*(cos(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) - sin(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*sin(b1(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))) - l*cos(b2(i))*sin(b1(i))*(sin(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))))))*((h - l*cos(b1(i))*cos(b2(i)))*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) - Y(i) + l*cos(q2(i))*sin(b2(i))*sin(q1(i)) + l*cos(b2(i))*sin(b1(i))*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i)))) + (mp*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i)))*((a*(dq3(i) - dq1(i)*sin(q2(i))))/2 + (b*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 - dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) + dY(i)*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i))) - (b*cos(gama1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 + (b*sin(gama1(i))*(dq3(i) - dq1(i)*sin(q2(i))))/2 - dZ(i)*cos(q2(i))*cos(q3(i))) - mp*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i)))*((b*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dX(i)*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) - dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) + (b*cos(gama1(i))*(dgama1(i) - dq2(i)*sin(q3(i)) + dq1(i)*cos(q2(i))*cos(q3(i))))/2 - dZ(i)*cos(q2(i))*sin(q3(i))) + mp*cos(q2(i))*sin(q1(i))*(dX(i)*cos(q1(i))*cos(q2(i)) - dZ(i)*sin(q2(i)) - (a*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + (b*sin(gama1(i))*(dgama1(i) - dq2(i)*sin(q3(i)) + dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dY(i)*cos(q2(i))*sin(q1(i))))*(sin(q2(i))*(b/2 - (b*cos(gama1(i)))/2) - Z(i) + cos(q2(i))*sin(q3(i))*(a/2 + (b*sin(gama1(i)))/2)) + Y(i)*dZ(i)*ms - Z(i)*dY(i)*ms + cos(q1(i))*cos(q2(i))*(Ixx*(dq3(i) - dq1(i)*sin(q2(i))) - Ixy*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + Ixz*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) - (c^2*mp*(cos(gama1(i))*(dq3(i) - dq1(i)*sin(q2(i))) + sin(gama1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))*(sin(gama1(i))*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) - cos(gama1(i))*cos(q1(i))*cos(q2(i))))/12 + (c^2*mp*(cos(gama2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - sin(gama2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))*(sin(gama2(i))*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) + cos(gama2(i))*cos(q1(i))*cos(q2(i))))/12 - (mp*(cos(gama1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(gama1(i))*(dq3(i) - dq1(i)*sin(q2(i))))*(cos(gama1(i))*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) + cos(q1(i))*cos(q2(i))*sin(gama1(i)))*(b^2 + c^2))/12 - (mp*(cos(gama2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + sin(gama2(i))*(dq3(i) - dq1(i)*sin(q2(i))))*(cos(gama2(i))*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) - cos(q1(i))*cos(q2(i))*sin(gama2(i)))*(b^2 + c^2))/12 + (b^2*mp*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i)))*(dgama1(i) - dq2(i)*sin(q3(i)) + dq1(i)*cos(q2(i))*cos(q3(i))))/12 - (b^2*mp*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i)))*(dgama2(i) + dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/12;
    HY(i)=(mf*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i)))*(dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) - h*(dq3(i) - dq1(i)*sin(q2(i))) - dY(i)*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i))) + dZ(i)*cos(q2(i))*cos(q3(i)) + l*sin(b2(i))*(sin(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) + cos(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) - cos(b1(i))*cos(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))) + l*cos(b1(i))*cos(b2(i))*(sin(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))))) - mf*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i)))*(dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) - dX(i)*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) + dZ(i)*cos(q2(i))*sin(q3(i)) + l*sin(b2(i))*(cos(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) - sin(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*sin(b1(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))) - l*cos(b2(i))*sin(b1(i))*(sin(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))))) + mf*cos(q1(i))*cos(q2(i))*(dX(i)*cos(q1(i))*cos(q2(i)) - dZ(i)*sin(q2(i)) - h*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) + dY(i)*cos(q2(i))*sin(q1(i)) + l*cos(b1(i))*cos(b2(i))*(cos(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) - sin(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*sin(b1(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))) + l*cos(b2(i))*sin(b1(i))*(sin(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) + cos(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) - cos(b1(i))*cos(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))))))*(Z(i) - cos(q2(i))*sin(q3(i))*(h - l*cos(b1(i))*cos(b2(i))) + l*sin(b2(i))*sin(q2(i)) + l*cos(b2(i))*cos(q2(i))*cos(q3(i))*sin(b1(i))) - (mf*cos(q2(i))*cos(q3(i))*(dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) - h*(dq3(i) - dq1(i)*sin(q2(i))) - dY(i)*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i))) + dZ(i)*cos(q2(i))*cos(q3(i)) + l*sin(b2(i))*(sin(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) + cos(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) - cos(b1(i))*cos(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))) + l*cos(b1(i))*cos(b2(i))*(sin(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))))) - mf*sin(q2(i))*(dX(i)*cos(q1(i))*cos(q2(i)) - dZ(i)*sin(q2(i)) - h*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) + dY(i)*cos(q2(i))*sin(q1(i)) + l*cos(b1(i))*cos(b2(i))*(cos(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) - sin(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*sin(b1(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))) + l*cos(b2(i))*sin(b1(i))*(sin(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) + cos(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) - cos(b1(i))*cos(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))))) + mf*cos(q2(i))*sin(q3(i))*(dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) - dX(i)*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) + dZ(i)*cos(q2(i))*sin(q3(i)) + l*sin(b2(i))*(cos(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) - sin(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*sin(b1(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))) - l*cos(b2(i))*sin(b1(i))*(sin(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))))))*(X(i) + (h - l*cos(b1(i))*cos(b2(i)))*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) - l*cos(q1(i))*cos(q2(i))*sin(b2(i)) + l*cos(b2(i))*sin(b1(i))*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i)))) + (Z(i) - sin(q2(i))*(b/2 - (b*cos(gama2(i)))/2) + cos(q2(i))*sin(q3(i))*(a/2 + (b*sin(gama2(i)))/2))*(mp*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i)))*((a*(dq3(i) - dq1(i)*sin(q2(i))))/2 - (b*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 + dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) - dY(i)*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i))) + (b*cos(gama2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 + (b*sin(gama2(i))*(dq3(i) - dq1(i)*sin(q2(i))))/2 + dZ(i)*cos(q2(i))*cos(q3(i))) - mp*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i)))*(dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) - dX(i)*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) - (b*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + (b*cos(gama2(i))*(dgama2(i) + dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dZ(i)*cos(q2(i))*sin(q3(i))) + mp*cos(q1(i))*cos(q2(i))*((a*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 - dZ(i)*sin(q2(i)) + dX(i)*cos(q1(i))*cos(q2(i)) + (b*sin(gama2(i))*(dgama2(i) + dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dY(i)*cos(q2(i))*sin(q1(i)))) + (cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i)))*(Iyy*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - Ixy*(dq3(i) - dq1(i)*sin(q2(i))) + Iyz*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + (cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i)))*(Ixz*(dq3(i) - dq1(i)*sin(q2(i))) + Iyz*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + Izz*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + (mp*sin(q2(i))*(dX(i)*cos(q1(i))*cos(q2(i)) - dZ(i)*sin(q2(i)) - (a*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + (b*sin(gama1(i))*(dgama1(i) - dq2(i)*sin(q3(i)) + dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dY(i)*cos(q2(i))*sin(q1(i))) + mp*cos(q2(i))*cos(q3(i))*((a*(dq3(i) - dq1(i)*sin(q2(i))))/2 + (b*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 - dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) + dY(i)*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i))) - (b*cos(gama1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 + (b*sin(gama1(i))*(dq3(i) - dq1(i)*sin(q2(i))))/2 - dZ(i)*cos(q2(i))*cos(q3(i))) + mp*cos(q2(i))*sin(q3(i))*((b*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dX(i)*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) - dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) + (b*cos(gama1(i))*(dgama1(i) - dq2(i)*sin(q3(i)) + dq1(i)*cos(q2(i))*cos(q3(i))))/2 - dZ(i)*cos(q2(i))*sin(q3(i))))*(X(i) + (cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i)))*(a/2 + (b*sin(gama1(i)))/2) + cos(q1(i))*cos(q2(i))*(b/2 - (b*cos(gama1(i)))/2)) - (mp*cos(q2(i))*cos(q3(i))*((a*(dq3(i) - dq1(i)*sin(q2(i))))/2 - (b*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 + dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) - dY(i)*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i))) + (b*cos(gama2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 + (b*sin(gama2(i))*(dq3(i) - dq1(i)*sin(q2(i))))/2 + dZ(i)*cos(q2(i))*cos(q3(i))) - mp*sin(q2(i))*((a*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 - dZ(i)*sin(q2(i)) + dX(i)*cos(q1(i))*cos(q2(i)) + (b*sin(gama2(i))*(dgama2(i) + dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dY(i)*cos(q2(i))*sin(q1(i))) + mp*cos(q2(i))*sin(q3(i))*(dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) - dX(i)*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) - (b*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + (b*cos(gama2(i))*(dgama2(i) + dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dZ(i)*cos(q2(i))*sin(q3(i))))*(X(i) - (cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i)))*(a/2 + (b*sin(gama2(i)))/2) + cos(q1(i))*cos(q2(i))*(b/2 - (b*cos(gama2(i)))/2)) - (mp*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i)))*((b*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dX(i)*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) - dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) + (b*cos(gama1(i))*(dgama1(i) - dq2(i)*sin(q3(i)) + dq1(i)*cos(q2(i))*cos(q3(i))))/2 - dZ(i)*cos(q2(i))*sin(q3(i))) - mp*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i)))*((a*(dq3(i) - dq1(i)*sin(q2(i))))/2 + (b*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 - dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) + dY(i)*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i))) - (b*cos(gama1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 + (b*sin(gama1(i))*(dq3(i) - dq1(i)*sin(q2(i))))/2 - dZ(i)*cos(q2(i))*cos(q3(i))) + mp*cos(q1(i))*cos(q2(i))*(dX(i)*cos(q1(i))*cos(q2(i)) - dZ(i)*sin(q2(i)) - (a*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + (b*sin(gama1(i))*(dgama1(i) - dq2(i)*sin(q3(i)) + dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dY(i)*cos(q2(i))*sin(q1(i))))*(sin(q2(i))*(b/2 - (b*cos(gama1(i)))/2) - Z(i) + cos(q2(i))*sin(q3(i))*(a/2 + (b*sin(gama1(i)))/2)) - X(i)*dZ(i)*ms + Z(i)*dX(i)*ms + cos(q2(i))*sin(q1(i))*(Ixx*(dq3(i) - dq1(i)*sin(q2(i))) - Ixy*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + Ixz*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + (c^2*mp*(cos(gama1(i))*(dq3(i) - dq1(i)*sin(q2(i))) + sin(gama1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))*(sin(gama1(i))*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) + cos(gama1(i))*cos(q2(i))*sin(q1(i))))/12 - (c^2*mp*(cos(gama2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - sin(gama2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))*(sin(gama2(i))*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) - cos(gama2(i))*cos(q2(i))*sin(q1(i))))/12 + (mp*(cos(gama1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(gama1(i))*(dq3(i) - dq1(i)*sin(q2(i))))*(b^2 + c^2)*(cos(gama1(i))*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) - cos(q2(i))*sin(gama1(i))*sin(q1(i))))/12 + (mp*(cos(gama2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + sin(gama2(i))*(dq3(i) - dq1(i)*sin(q2(i))))*(b^2 + c^2)*(cos(gama2(i))*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) + cos(q2(i))*sin(gama2(i))*sin(q1(i))))/12 - (b^2*mp*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i)))*(dgama1(i) - dq2(i)*sin(q3(i)) + dq1(i)*cos(q2(i))*cos(q3(i))))/12 + (b^2*mp*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i)))*(dgama2(i) + dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/12;
    HZ(i)=(mf*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i)))*(dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) - h*(dq3(i) - dq1(i)*sin(q2(i))) - dY(i)*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i))) + dZ(i)*cos(q2(i))*cos(q3(i)) + l*sin(b2(i))*(sin(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) + cos(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) - cos(b1(i))*cos(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))) + l*cos(b1(i))*cos(b2(i))*(sin(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))))) - mf*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i)))*(dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) - dX(i)*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) + dZ(i)*cos(q2(i))*sin(q3(i)) + l*sin(b2(i))*(cos(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) - sin(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*sin(b1(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))) - l*cos(b2(i))*sin(b1(i))*(sin(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))))) + mf*cos(q1(i))*cos(q2(i))*(dX(i)*cos(q1(i))*cos(q2(i)) - dZ(i)*sin(q2(i)) - h*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) + dY(i)*cos(q2(i))*sin(q1(i)) + l*cos(b1(i))*cos(b2(i))*(cos(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) - sin(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*sin(b1(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))) + l*cos(b2(i))*sin(b1(i))*(sin(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) + cos(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) - cos(b1(i))*cos(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))))))*((h - l*cos(b1(i))*cos(b2(i)))*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) - Y(i) + l*cos(q2(i))*sin(b2(i))*sin(q1(i)) + l*cos(b2(i))*sin(b1(i))*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i)))) + (mf*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i)))*(dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) - dX(i)*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) + dZ(i)*cos(q2(i))*sin(q3(i)) + l*sin(b2(i))*(cos(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) - sin(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*sin(b1(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))) - l*cos(b2(i))*sin(b1(i))*(sin(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))))) - mf*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i)))*(dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) - h*(dq3(i) - dq1(i)*sin(q2(i))) - dY(i)*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i))) + dZ(i)*cos(q2(i))*cos(q3(i)) + l*sin(b2(i))*(sin(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) + cos(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) - cos(b1(i))*cos(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))) + l*cos(b1(i))*cos(b2(i))*(sin(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))))) + mf*cos(q2(i))*sin(q1(i))*(dX(i)*cos(q1(i))*cos(q2(i)) - dZ(i)*sin(q2(i)) - h*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) + dY(i)*cos(q2(i))*sin(q1(i)) + l*cos(b1(i))*cos(b2(i))*(cos(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) - sin(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(b2(i))*sin(b1(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))) + l*cos(b2(i))*sin(b1(i))*(sin(b1(i))*(cos(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))) - db2(i) + sin(b1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))) + cos(b1(i))*sin(b2(i))*(db1(i) + cos(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) + cos(b1(i))*sin(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(b1(i))*sin(b2(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) - cos(b1(i))*cos(b2(i))*(sin(b2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - cos(b1(i))*cos(b2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + cos(b2(i))*sin(b1(i))*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))))))*(X(i) + (h - l*cos(b1(i))*cos(b2(i)))*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) - l*cos(q1(i))*cos(q2(i))*sin(b2(i)) + l*cos(b2(i))*sin(b1(i))*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i)))) + (mp*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i)))*((a*(dq3(i) - dq1(i)*sin(q2(i))))/2 + (b*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 - dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) + dY(i)*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i))) - (b*cos(gama1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 + (b*sin(gama1(i))*(dq3(i) - dq1(i)*sin(q2(i))))/2 - dZ(i)*cos(q2(i))*cos(q3(i))) - mp*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i)))*((b*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dX(i)*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) - dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) + (b*cos(gama1(i))*(dgama1(i) - dq2(i)*sin(q3(i)) + dq1(i)*cos(q2(i))*cos(q3(i))))/2 - dZ(i)*cos(q2(i))*sin(q3(i))) + mp*cos(q2(i))*sin(q1(i))*(dX(i)*cos(q1(i))*cos(q2(i)) - dZ(i)*sin(q2(i)) - (a*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + (b*sin(gama1(i))*(dgama1(i) - dq2(i)*sin(q3(i)) + dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dY(i)*cos(q2(i))*sin(q1(i))))*(X(i) + (cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i)))*(a/2 + (b*sin(gama1(i)))/2) + cos(q1(i))*cos(q2(i))*(b/2 - (b*cos(gama1(i)))/2)) + (mp*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i)))*(dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) - dX(i)*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) - (b*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + (b*cos(gama2(i))*(dgama2(i) + dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dZ(i)*cos(q2(i))*sin(q3(i))) - mp*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i)))*((a*(dq3(i) - dq1(i)*sin(q2(i))))/2 - (b*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 + dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) - dY(i)*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i))) + (b*cos(gama2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 + (b*sin(gama2(i))*(dq3(i) - dq1(i)*sin(q2(i))))/2 + dZ(i)*cos(q2(i))*cos(q3(i))) + mp*cos(q2(i))*sin(q1(i))*((a*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 - dZ(i)*sin(q2(i)) + dX(i)*cos(q1(i))*cos(q2(i)) + (b*sin(gama2(i))*(dgama2(i) + dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dY(i)*cos(q2(i))*sin(q1(i))))*(X(i) - (cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i)))*(a/2 + (b*sin(gama2(i)))/2) + cos(q1(i))*cos(q2(i))*(b/2 - (b*cos(gama2(i)))/2)) - (Y(i) - (cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i)))*(a/2 + (b*sin(gama1(i)))/2) + cos(q2(i))*sin(q1(i))*(b/2 - (b*cos(gama1(i)))/2))*(mp*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i)))*((b*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dX(i)*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) - dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) + (b*cos(gama1(i))*(dgama1(i) - dq2(i)*sin(q3(i)) + dq1(i)*cos(q2(i))*cos(q3(i))))/2 - dZ(i)*cos(q2(i))*sin(q3(i))) - mp*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i)))*((a*(dq3(i) - dq1(i)*sin(q2(i))))/2 + (b*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 - dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) + dY(i)*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i))) - (b*cos(gama1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 + (b*sin(gama1(i))*(dq3(i) - dq1(i)*sin(q2(i))))/2 - dZ(i)*cos(q2(i))*cos(q3(i))) + mp*cos(q1(i))*cos(q2(i))*(dX(i)*cos(q1(i))*cos(q2(i)) - dZ(i)*sin(q2(i)) - (a*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + (b*sin(gama1(i))*(dgama1(i) - dq2(i)*sin(q3(i)) + dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dY(i)*cos(q2(i))*sin(q1(i)))) - (Y(i) + (cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i)))*(a/2 + (b*sin(gama2(i)))/2) + cos(q2(i))*sin(q1(i))*(b/2 - (b*cos(gama2(i)))/2))*(mp*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i)))*((a*(dq3(i) - dq1(i)*sin(q2(i))))/2 - (b*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 + dX(i)*(sin(q1(i))*sin(q3(i)) + cos(q1(i))*cos(q3(i))*sin(q2(i))) - dY(i)*(cos(q1(i))*sin(q3(i)) - cos(q3(i))*sin(q1(i))*sin(q2(i))) + (b*cos(gama2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))))/2 + (b*sin(gama2(i))*(dq3(i) - dq1(i)*sin(q2(i))))/2 + dZ(i)*cos(q2(i))*cos(q3(i))) - mp*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i)))*(dY(i)*(cos(q1(i))*cos(q3(i)) + sin(q1(i))*sin(q2(i))*sin(q3(i))) - dX(i)*(cos(q3(i))*sin(q1(i)) - cos(q1(i))*sin(q2(i))*sin(q3(i))) - (b*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + (b*cos(gama2(i))*(dgama2(i) + dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dZ(i)*cos(q2(i))*sin(q3(i))) + mp*cos(q1(i))*cos(q2(i))*((a*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 - dZ(i)*sin(q2(i)) + dX(i)*cos(q1(i))*cos(q2(i)) + (b*sin(gama2(i))*(dgama2(i) + dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/2 + dY(i)*cos(q2(i))*sin(q1(i)))) - sin(q2(i))*(Ixx*(dq3(i) - dq1(i)*sin(q2(i))) - Ixy*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + Ixz*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + X(i)*dY(i)*ms - Y(i)*dX(i)*ms - cos(q2(i))*cos(q3(i))*(Ixz*(dq3(i) - dq1(i)*sin(q2(i))) + Iyz*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + Izz*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) + cos(q2(i))*sin(q3(i))*(Iyy*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - Ixy*(dq3(i) - dq1(i)*sin(q2(i))) + Iyz*(dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i)))) - (c^2*mp*(cos(gama1(i))*sin(q2(i)) - cos(q2(i))*sin(gama1(i))*sin(q3(i)))*(cos(gama1(i))*(dq3(i) - dq1(i)*sin(q2(i))) + sin(gama1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))))/12 - (c^2*mp*(cos(gama2(i))*sin(q2(i)) + cos(q2(i))*sin(gama2(i))*sin(q3(i)))*(cos(gama2(i))*(dq3(i) - dq1(i)*sin(q2(i))) - sin(gama2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i)))))/12 + (mp*(sin(gama1(i))*sin(q2(i)) + cos(gama1(i))*cos(q2(i))*sin(q3(i)))*(cos(gama1(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) - sin(gama1(i))*(dq3(i) - dq1(i)*sin(q2(i))))*(b^2 + c^2))/12 - (mp*(sin(gama2(i))*sin(q2(i)) - cos(gama2(i))*cos(q2(i))*sin(q3(i)))*(cos(gama2(i))*(dq2(i)*cos(q3(i)) + dq1(i)*cos(q2(i))*sin(q3(i))) + sin(gama2(i))*(dq3(i) - dq1(i)*sin(q2(i))))*(b^2 + c^2))/12 + (b^2*mp*cos(q2(i))*cos(q3(i))*(dgama1(i) - dq2(i)*sin(q3(i)) + dq1(i)*cos(q2(i))*cos(q3(i))))/12 - (b^2*mp*cos(q2(i))*cos(q3(i))*(dgama2(i) + dq2(i)*sin(q3(i)) - dq1(i)*cos(q2(i))*cos(q3(i))))/12;
    HX_error(i)=(HX(i)-HX(1))/HX(1)*100;
    HY_error(i)=(HY(i)-HY(1))/HY(1)*100;
    HZ_error(i)=(HZ(i)-HZ(1))/HZ(1)*100;
end

checking_values=[E_error.' PX_error.' PY_error.' PZ_error.' HX_error.' HY_error.' HZ_error.'];