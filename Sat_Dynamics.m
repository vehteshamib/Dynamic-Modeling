function dz = Sat_Dynamics(t,z)

global ms mp mf Ixx Iyy Izz Ixy Ixz Iyz a b c h l ks gamas

X = z(1); Y = z(2); Z = z(3); q1 = z(4); q2 = z(5); q3 = z(6);
gama1 = z(7); gama2 = z(8); b1 = z(9); b2 = z(10);
dX = z(11); dY = z(12); dZ = z(13); dq1 = z(14); dq2 = z(15); dq3 = z(16);
dgama1 = z(17); dgama2 = z(18); db1 = z(19); db2 = z(20);                 

M(:,1) =[                                                                                                                                                                                                                                                                   ms + mf*(sin(q1)*sin(q3) + cos(q1)*cos(q3)*sin(q2))^2 + mf*(cos(q3)*sin(q1) - cos(q1)*sin(q2)*sin(q3))^2 + 2*mp*(sin(q1)*sin(q3) + cos(q1)*cos(q3)*sin(q2))^2 + 2*mp*(cos(q3)*sin(q1) - cos(q1)*sin(q2)*sin(q3))^2 + mf*cos(q1)^2*cos(q2)^2 + 2*mp*cos(q1)^2*cos(q2)^2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0
 h*mf*cos(q1)*cos(q3) - b*mp*cos(q2)*sin(q1) + (b*mp*cos(gama1)*cos(q2)*sin(q1))/2 + (b*mp*cos(gama2)*cos(q2)*sin(q1))/2 + (b*mp*cos(q1)*cos(q3)*sin(gama1))/2 - (b*mp*cos(q1)*cos(q3)*sin(gama2))/2 + l*mf*cos(q2)*sin(b2)*sin(q1) + h*mf*sin(q1)*sin(q2)*sin(q3) - l*mf*cos(b1)*cos(b2)*cos(q1)*cos(q3) + l*mf*cos(b2)*cos(q1)*sin(b1)*sin(q3) + (b*mp*sin(gama1)*sin(q1)*sin(q2)*sin(q3))/2 - (b*mp*sin(gama2)*sin(q1)*sin(q2)*sin(q3))/2 - l*mf*cos(b1)*cos(b2)*sin(q1)*sin(q2)*sin(q3) - l*mf*cos(b2)*cos(q3)*sin(b1)*sin(q1)*sin(q2)
                                                                                                                                                                                                                                                  (cos(q1)*(b*mp*cos(gama1)*sin(q2) - 2*b*mp*sin(q2) + b*mp*cos(gama2)*sin(q2) - 2*h*mf*cos(q2)*sin(q3) + 2*l*mf*sin(b2)*sin(q2) - b*mp*cos(q2)*sin(gama1)*sin(q3) + b*mp*cos(q2)*sin(gama2)*sin(q3) + 2*l*mf*cos(b1)*cos(b2)*cos(q2)*sin(q3) + 2*l*mf*cos(b2)*cos(q2)*cos(q3)*sin(b1)))/2
                                                                                                                                                                                                                                             mp*(sin(q1)*sin(q3) + cos(q1)*cos(q3)*sin(q2))*(a/2 + (b*sin(gama2))/2) - mp*(sin(q1)*sin(q3) + cos(q1)*cos(q3)*sin(q2))*(a/2 + (b*sin(gama1))/2) - mf*(h - l*cos(b1)*cos(b2))*(sin(q1)*sin(q3) + cos(q1)*cos(q3)*sin(q2)) + l*mf*cos(b2)*sin(b1)*(cos(q3)*sin(q1) - cos(q1)*sin(q2)*sin(q3))
                                                                                                                                                                                                                                                                                                                                                                                                                                     (b*mp*cos(gama1)*(cos(q3)*sin(q1) - cos(q1)*sin(q2)*sin(q3)))/2 + (b*mp*cos(q1)*cos(q2)*sin(gama1))/2
                                                                                                                                                                                                                                                                                                                                                                                                                                     (b*mp*cos(q1)*cos(q2)*sin(gama2))/2 - (b*mp*cos(gama2)*(cos(q3)*sin(q1) - cos(q1)*sin(q2)*sin(q3)))/2
                                                                                                                                                                                                                                                                                                                                                                                                              l*mf*(cos(b1)*sin(q1)*sin(q3) + cos(q3)*sin(b1)*sin(q1) + cos(b1)*cos(q1)*cos(q3)*sin(q2) - cos(q1)*sin(b1)*sin(q2)*sin(q3))
                                                                                                                                                                                                                                                                                                                                                                        l*mf*cos(b1)*sin(b2)*(cos(q3)*sin(q1) - cos(q1)*sin(q2)*sin(q3)) - l*mf*sin(b1)*sin(b2)*(sin(q1)*sin(q3) + cos(q1)*cos(q3)*sin(q2)) - l*mf*cos(b2)*cos(q1)*cos(q2)];
M(:,2) =[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            mf + 2*mp + ms
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0
 b*mp*cos(q1)*cos(q2) + h*mf*cos(q3)*sin(q1) - (b*mp*cos(gama1)*cos(q1)*cos(q2))/2 - (b*mp*cos(gama2)*cos(q1)*cos(q2))/2 - l*mf*cos(q1)*cos(q2)*sin(b2) + (b*mp*cos(q3)*sin(gama1)*sin(q1))/2 - (b*mp*cos(q3)*sin(gama2)*sin(q1))/2 - h*mf*cos(q1)*sin(q2)*sin(q3) - l*mf*cos(b1)*cos(b2)*cos(q3)*sin(q1) + l*mf*cos(b2)*sin(b1)*sin(q1)*sin(q3) - (b*mp*cos(q1)*sin(gama1)*sin(q2)*sin(q3))/2 + (b*mp*cos(q1)*sin(gama2)*sin(q2)*sin(q3))/2 + l*mf*cos(b1)*cos(b2)*cos(q1)*sin(q2)*sin(q3) + l*mf*cos(b2)*cos(q1)*cos(q3)*sin(b1)*sin(q2)
                                                                                                                                                                                                                                                  (sin(q1)*(b*mp*cos(gama1)*sin(q2) - 2*b*mp*sin(q2) + b*mp*cos(gama2)*sin(q2) - 2*h*mf*cos(q2)*sin(q3) + 2*l*mf*sin(b2)*sin(q2) - b*mp*cos(q2)*sin(gama1)*sin(q3) + b*mp*cos(q2)*sin(gama2)*sin(q3) + 2*l*mf*cos(b1)*cos(b2)*cos(q2)*sin(q3) + 2*l*mf*cos(b2)*cos(q2)*cos(q3)*sin(b1)))/2
                                                                                                                                                                                                                                             mf*(h - l*cos(b1)*cos(b2))*(cos(q1)*sin(q3) - cos(q3)*sin(q1)*sin(q2)) + mp*(cos(q1)*sin(q3) - cos(q3)*sin(q1)*sin(q2))*(a/2 + (b*sin(gama1))/2) - mp*(cos(q1)*sin(q3) - cos(q3)*sin(q1)*sin(q2))*(a/2 + (b*sin(gama2))/2) - l*mf*cos(b2)*sin(b1)*(cos(q1)*cos(q3) + sin(q1)*sin(q2)*sin(q3))
                                                                                                                                                                                                                                                                                                                                                                                                                                     (b*mp*cos(q2)*sin(gama1)*sin(q1))/2 - (b*mp*cos(gama1)*(cos(q1)*cos(q3) + sin(q1)*sin(q2)*sin(q3)))/2
                                                                                                                                                                                                                                                                                                                                                                                                                                     (b*mp*cos(gama2)*(cos(q1)*cos(q3) + sin(q1)*sin(q2)*sin(q3)))/2 + (b*mp*cos(q2)*sin(gama2)*sin(q1))/2
                                                                                                                                                                                                                                                                                                                                                                                                             -l*mf*(cos(b1)*cos(q1)*sin(q3) + cos(q1)*cos(q3)*sin(b1) - cos(b1)*cos(q3)*sin(q1)*sin(q2) + sin(b1)*sin(q1)*sin(q2)*sin(q3))
                                                                                                                                                                                                                                                                                                                                                                        l*mf*sin(b1)*sin(b2)*(cos(q1)*sin(q3) - cos(q3)*sin(q1)*sin(q2)) - l*mf*cos(b1)*sin(b2)*(cos(q1)*cos(q3) + sin(q1)*sin(q2)*sin(q3)) - l*mf*cos(b2)*cos(q2)*sin(q1)];
M(:,3) =[                                                                                                                                                                                                                                                                                0
                                                                                                                                                                                                                                                                                0
                                                                                                                                                                                                                                                                   mf + 2*mp + ms
                                                                                                                                                                                                                                                                                0
 (b*mp*cos(gama1)*cos(q2))/2 - b*mp*cos(q2) + (b*mp*cos(gama2)*cos(q2))/2 + l*mf*cos(q2)*sin(b2) + h*mf*sin(q2)*sin(q3) + (b*mp*sin(gama1)*sin(q2)*sin(q3))/2 - (b*mp*sin(gama2)*sin(q2)*sin(q3))/2 - l*mf*cos(b1)*cos(b2)*sin(q2)*sin(q3) - l*mf*cos(b2)*cos(q3)*sin(b1)*sin(q2)
                                                                                                                              -(cos(q2)*(2*h*mf*cos(q3) + b*mp*cos(q3)*sin(gama1) - b*mp*cos(q3)*sin(gama2) - 2*l*mf*cos(b1)*cos(b2)*cos(q3) + 2*l*mf*cos(b2)*sin(b1)*sin(q3)))/2
                                                                                                                                                                                                                      -(b*mp*(sin(gama1)*sin(q2) + cos(gama1)*cos(q2)*sin(q3)))/2
                                                                                                                                                                                                                      -(b*mp*(sin(gama2)*sin(q2) - cos(gama2)*cos(q2)*sin(q3)))/2
                                                                                                                                                                                                                                                        l*mf*cos(b1 + q3)*cos(q2)
                                                                                                                                                                                      -l*mf*(cos(b1)*cos(q2)*sin(b2)*sin(q3) - cos(b2)*sin(q2) + cos(q2)*cos(q3)*sin(b1)*sin(b2))];
M(:,4) =[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  h*mf*cos(q1)*cos(q3) - b*mp*cos(q2)*sin(q1) + (b*mp*cos(gama1)*cos(q2)*sin(q1))/2 + (b*mp*cos(gama2)*cos(q2)*sin(q1))/2 + (b*mp*cos(q1)*cos(q3)*sin(gama1))/2 - (b*mp*cos(q1)*cos(q3)*sin(gama2))/2 + l*mf*cos(q2)*sin(b2)*sin(q1) + h*mf*sin(q1)*sin(q2)*sin(q3) - l*mf*cos(b1)*cos(b2)*cos(q1)*cos(q3) + l*mf*cos(b2)*cos(q1)*sin(b1)*sin(q3) + (b*mp*sin(gama1)*sin(q1)*sin(q2)*sin(q3))/2 - (b*mp*sin(gama2)*sin(q1)*sin(q2)*sin(q3))/2 - l*mf*cos(b1)*cos(b2)*sin(q1)*sin(q2)*sin(q3) - l*mf*cos(b2)*cos(q3)*sin(b1)*sin(q1)*sin(q2)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   b*mp*cos(q1)*cos(q2) + h*mf*cos(q3)*sin(q1) - (b*mp*cos(gama1)*cos(q1)*cos(q2))/2 - (b*mp*cos(gama2)*cos(q1)*cos(q2))/2 - l*mf*cos(q1)*cos(q2)*sin(b2) + (b*mp*cos(q3)*sin(gama1)*sin(q1))/2 - (b*mp*cos(q3)*sin(gama2)*sin(q1))/2 - h*mf*cos(q1)*sin(q2)*sin(q3) - l*mf*cos(b1)*cos(b2)*cos(q3)*sin(q1) + l*mf*cos(b2)*sin(b1)*sin(q1)*sin(q3) - (b*mp*cos(q1)*sin(gama1)*sin(q2)*sin(q3))/2 + (b*mp*cos(q1)*sin(gama2)*sin(q2)*sin(q3))/2 + l*mf*cos(b1)*cos(b2)*cos(q1)*sin(q2)*sin(q3) + l*mf*cos(b2)*cos(q1)*cos(q3)*sin(b1)*sin(q2)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           0
 (mp*(a*sin(q2) - b*cos(q2)*sin(q3) + b*sin(gama1)*sin(q2) + b*cos(gama1)*cos(q2)*sin(q3))^2)/4 + (mp*(a*sin(q2) + b*cos(q2)*sin(q3) + b*sin(gama2)*sin(q2) - b*cos(gama2)*cos(q2)*sin(q3))^2)/4 + mf*(h*sin(q2) - l*cos(b1)*cos(b2)*sin(q2) + l*cos(q2)*sin(b2)*sin(q3))^2 + sin(q2)*(Ixx*sin(q2) + Ixz*cos(q2)*cos(q3) + Ixy*cos(q2)*sin(q3)) + l^2*mf*(cos(q2)*cos(q3)*sin(b2) - cos(b2)*sin(b1)*sin(q2))^2 + cos(q2)*cos(q3)*(Ixz*sin(q2) + Izz*cos(q2)*cos(q3) - Iyz*cos(q2)*sin(q3)) + cos(q2)*sin(q3)*(Ixy*sin(q2) - Iyz*cos(q2)*cos(q3) + Iyy*cos(q2)*sin(q3)) + mf*cos(q2)^2*(h*cos(q3) - l*cos(b1)*cos(b2)*cos(q3) + l*cos(b2)*sin(b1)*sin(q3))^2 + (c^2*mp*(cos(gama1)*sin(q2) - cos(q2)*sin(gama1)*sin(q3))*((cos(gama1)*sin(q2))/2 - (cos(q2)*sin(gama1)*sin(q3))/2))/6 + (c^2*mp*(cos(gama2)*sin(q2) + cos(q2)*sin(gama2)*sin(q3))*((cos(gama2)*sin(q2))/2 + (cos(q2)*sin(gama2)*sin(q3))/2))/6 + (mp*(sin(gama1)*sin(q2) + cos(gama1)*cos(q2)*sin(q3))*((sin(gama1)*sin(q2))/2 + (cos(gama1)*cos(q2)*sin(q3))/2)*(b^2 + c^2))/6 + (mp*(sin(gama2)*sin(q2) - cos(gama2)*cos(q2)*sin(q3))*((sin(gama2)*sin(q2))/2 - (cos(gama2)*cos(q2)*sin(q3))/2)*(b^2 + c^2))/6 + (mp*cos(q2)^2*cos(q3)^2*(a + b*sin(gama1))^2)/4 + (mp*cos(q2)^2*cos(q3)^2*(a + b*sin(gama2))^2)/4 + (b^2*mp*cos(q2)^2*cos(q3)^2)/6 + (b^2*mp*cos(q2)^2*cos(q3)^2*(cos(gama1) - 1)^2)/4 + (b^2*mp*cos(q2)^2*cos(q3)^2*(cos(gama2) - 1)^2)/4
                                                                                                                                                                           Iyz*cos(q2) + Ixy*cos(q3)*sin(q2) - Ixz*sin(q2)*sin(q3) - 2*Iyz*cos(q2)*cos(q3)^2 + Iyy*cos(q2)*cos(q3)*sin(q3) - Izz*cos(q2)*cos(q3)*sin(q3) - (a^2*mp*cos(q2)*cos(q3)*sin(q3))/2 - (2*b^2*mp*cos(q2)*cos(q3)*sin(q3))/3 + (c^2*mp*cos(q2)*cos(q3)*sin(q3))/6 - h^2*mf*cos(q2)*cos(q3)*sin(q3) - (b^2*mp*cos(q3)*sin(gama1)*sin(q2))/4 + (b^2*mp*cos(q3)*sin(gama2)*sin(q2))/4 - h*l*mf*cos(b2)*cos(q2)*sin(b1) + (a*b*mp*cos(gama1)*cos(q3)*sin(q2))/4 - (a*b*mp*cos(gama2)*cos(q3)*sin(q2))/4 + l^2*mf*cos(b1)*cos(b2)^2*cos(q2)*sin(b1) + h*l*mf*cos(q3)*sin(b2)*sin(q2) + (b^2*mp*cos(gama1)^2*cos(q2)*cos(q3)*sin(q3))/3 + (b^2*mp*cos(gama2)^2*cos(q2)*cos(q3)*sin(q3))/3 + l^2*mf*cos(b2)^2*cos(q2)*cos(q3)*sin(q3) + (b^2*mp*cos(gama1)*cos(q3)*sin(gama1)*sin(q2))/3 - (b^2*mp*cos(gama2)*cos(q3)*sin(gama2)*sin(q2))/3 + 2*h*l*mf*cos(b2)*cos(q2)*cos(q3)^2*sin(b1) - 2*l^2*mf*cos(b1)*cos(b2)^2*cos(q2)*cos(q3)^2*sin(b1) - 2*l^2*mf*cos(b1)^2*cos(b2)^2*cos(q2)*cos(q3)*sin(q3) - l^2*mf*cos(b1)*cos(b2)*cos(q3)*sin(b2)*sin(q2) + l^2*mf*cos(b2)*sin(b1)*sin(b2)*sin(q2)*sin(q3) - (a*b*mp*cos(q2)*cos(q3)*sin(gama1)*sin(q3))/2 - (a*b*mp*cos(q2)*cos(q3)*sin(gama2)*sin(q3))/2 + 2*h*l*mf*cos(b1)*cos(b2)*cos(q2)*cos(q3)*sin(q3)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        (b^2*mp*cos(gama1)^2*sin(q2))/3 - Ixz*cos(q2)*cos(q3) - Ixy*cos(q2)*sin(q3) - (a^2*mp*sin(q2))/2 - (2*b^2*mp*sin(q2))/3 - (c^2*mp*sin(q2))/6 - h^2*mf*sin(q2) - Ixx*sin(q2) + (b^2*mp*cos(gama2)^2*sin(q2))/3 - l^2*mf*cos(b2)^2*sin(q2) + (b^2*mp*cos(q2)*sin(gama1)*sin(q3))/4 - (b^2*mp*cos(q2)*sin(gama2)*sin(q3))/4 - (a*b*mp*sin(gama1)*sin(q2))/2 - (a*b*mp*sin(gama2)*sin(q2))/2 + 2*h*l*mf*cos(b1)*cos(b2)*sin(q2) - (a*b*mp*cos(gama1)*cos(q2)*sin(q3))/4 + (a*b*mp*cos(gama2)*cos(q2)*sin(q3))/4 - h*l*mf*cos(q2)*sin(b2)*sin(q3) - (b^2*mp*cos(gama1)*cos(q2)*sin(gama1)*sin(q3))/3 + (b^2*mp*cos(gama2)*cos(q2)*sin(gama2)*sin(q3))/3 + l^2*mf*cos(b1)*cos(b2)*cos(q2)*sin(b2)*sin(q3) + l^2*mf*cos(b2)*cos(q2)*cos(q3)*sin(b1)*sin(b2)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           (b*mp*cos(q2)*cos(q3)*(4*b - 3*b*cos(gama1) + 3*a*sin(gama1)))/12
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          -(b*mp*cos(q2)*cos(q3)*(4*b - 3*b*cos(gama2) + 3*a*sin(gama2)))/12
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        l*mf*(h*cos(b1)*sin(q2) - l*cos(b2)*sin(q2) + l*cos(b1)*cos(q2)*sin(b2)*sin(q3) + l*cos(q2)*cos(q3)*sin(b1)*sin(b2))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       -l*mf*(h*cos(b2)*cos(q2)*cos(q3) - l*cos(b1)*cos(q2)*cos(q3) + h*sin(b1)*sin(b2)*sin(q2) + l*cos(q2)*sin(b1)*sin(q3))];
M(:,5) =[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (cos(q1)*(b*mp*cos(gama1)*sin(q2) - 2*b*mp*sin(q2) + b*mp*cos(gama2)*sin(q2) - 2*h*mf*cos(q2)*sin(q3) + 2*l*mf*sin(b2)*sin(q2) - b*mp*cos(q2)*sin(gama1)*sin(q3) + b*mp*cos(q2)*sin(gama2)*sin(q3) + 2*l*mf*cos(b1)*cos(b2)*cos(q2)*sin(q3) + 2*l*mf*cos(b2)*cos(q2)*cos(q3)*sin(b1)))/2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (sin(q1)*(b*mp*cos(gama1)*sin(q2) - 2*b*mp*sin(q2) + b*mp*cos(gama2)*sin(q2) - 2*h*mf*cos(q2)*sin(q3) + 2*l*mf*sin(b2)*sin(q2) - b*mp*cos(q2)*sin(gama1)*sin(q3) + b*mp*cos(q2)*sin(gama2)*sin(q3) + 2*l*mf*cos(b1)*cos(b2)*cos(q2)*sin(q3) + 2*l*mf*cos(b2)*cos(q2)*cos(q3)*sin(b1)))/2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  (b*mp*cos(gama1)*cos(q2))/2 - b*mp*cos(q2) + (b*mp*cos(gama2)*cos(q2))/2 + l*mf*cos(q2)*sin(b2) + h*mf*sin(q2)*sin(q3) + (b*mp*sin(gama1)*sin(q2)*sin(q3))/2 - (b*mp*sin(gama2)*sin(q2)*sin(q3))/2 - l*mf*cos(b1)*cos(b2)*sin(q2)*sin(q3) - l*mf*cos(b2)*cos(q3)*sin(b1)*sin(q2)
 Iyz*cos(q2) + Ixy*cos(q3)*sin(q2) - Ixz*sin(q2)*sin(q3) - 2*Iyz*cos(q2)*cos(q3)^2 + Iyy*cos(q2)*cos(q3)*sin(q3) - Izz*cos(q2)*cos(q3)*sin(q3) - (a^2*mp*cos(q2)*cos(q3)*sin(q3))/2 - (2*b^2*mp*cos(q2)*cos(q3)*sin(q3))/3 + (c^2*mp*cos(q2)*cos(q3)*sin(q3))/6 - h^2*mf*cos(q2)*cos(q3)*sin(q3) - (b^2*mp*cos(q3)*sin(gama1)*sin(q2))/4 + (b^2*mp*cos(q3)*sin(gama2)*sin(q2))/4 - h*l*mf*cos(b2)*cos(q2)*sin(b1) + (a*b*mp*cos(gama1)*cos(q3)*sin(q2))/4 - (a*b*mp*cos(gama2)*cos(q3)*sin(q2))/4 + l^2*mf*cos(b1)*cos(b2)^2*cos(q2)*sin(b1) + h*l*mf*cos(q3)*sin(b2)*sin(q2) + (b^2*mp*cos(gama1)^2*cos(q2)*cos(q3)*sin(q3))/3 + (b^2*mp*cos(gama2)^2*cos(q2)*cos(q3)*sin(q3))/3 + l^2*mf*cos(b2)^2*cos(q2)*cos(q3)*sin(q3) + (b^2*mp*cos(gama1)*cos(q3)*sin(gama1)*sin(q2))/3 - (b^2*mp*cos(gama2)*cos(q3)*sin(gama2)*sin(q2))/3 + 2*h*l*mf*cos(b2)*cos(q2)*cos(q3)^2*sin(b1) - 2*l^2*mf*cos(b1)*cos(b2)^2*cos(q2)*cos(q3)^2*sin(b1) - 2*l^2*mf*cos(b1)^2*cos(b2)^2*cos(q2)*cos(q3)*sin(q3) - l^2*mf*cos(b1)*cos(b2)*cos(q3)*sin(b2)*sin(q2) + l^2*mf*cos(b2)*sin(b1)*sin(b2)*sin(q2)*sin(q3) - (a*b*mp*cos(q2)*cos(q3)*sin(gama1)*sin(q3))/2 - (a*b*mp*cos(q2)*cos(q3)*sin(gama2)*sin(q3))/2 + 2*h*l*mf*cos(b1)*cos(b2)*cos(q2)*cos(q3)*sin(q3)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Iyy/2 + Izz/2 + (a^2*mp)/4 + (5*b^2*mp)/6 + (c^2*mp)/12 + (h^2*mf)/2 + l^2*mf + (Iyy*cos(2*q3))/2 - (Izz*cos(2*q3))/2 + Iyz*sin(2*q3) - (b^2*mp*cos(gama1))/2 - (b^2*mp*cos(gama2))/2 + (b^2*mp*cos(gama1)^2)/6 + (b^2*mp*cos(gama2)^2)/6 - (l^2*mf*cos(b2)^2)/2 - (a^2*mp*cos(2*q3))/4 - (b^2*mp*cos(2*q3))/3 + (c^2*mp*cos(2*q3))/12 - (h^2*mf*cos(2*q3))/2 + (a*b*mp*sin(gama1))/4 + (a*b*mp*sin(gama2))/4 + (b^2*mp*cos(2*q3)*cos(gama1)^2)/6 + (b^2*mp*cos(2*q3)*cos(gama2)^2)/6 + (l^2*mf*cos(2*q3)*cos(b2)^2)/2 - l^2*mf*cos(2*q3)*cos(b1)^2*cos(b2)^2 - h*l*mf*cos(b1)*cos(b2) - (a*b*mp*cos(2*q3)*sin(gama1))/4 - (a*b*mp*cos(2*q3)*sin(gama2))/4 + h*l*mf*cos(2*q3)*cos(b1)*cos(b2) - h*l*mf*sin(2*q3)*cos(b2)*sin(b1) + l^2*mf*sin(2*q3)*cos(b1)*cos(b2)^2*sin(b1)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Ixz*sin(q3) - Ixy*cos(q3) + (b^2*mp*cos(q3)*sin(gama1))/4 - (b^2*mp*cos(q3)*sin(gama2))/4 - (b^2*mp*sin(2*gama1)*cos(q3))/6 + (b^2*mp*sin(2*gama2)*cos(q3))/6 - (a*b*mp*cos(gama1)*cos(q3))/4 + (a*b*mp*cos(gama2)*cos(q3))/4 - h*l*mf*cos(q3)*sin(b2) + (l^2*mf*sin(2*b2)*cos(b1)*cos(q3))/2 - (l^2*mf*sin(2*b2)*sin(b1)*sin(q3))/2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        -(b*mp*sin(q3)*(4*b - 3*b*cos(gama1) + 3*a*sin(gama1)))/12
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         (b*mp*sin(q3)*(4*b - 3*b*cos(gama2) + 3*a*sin(gama2)))/12
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       l^2*mf*cos(b1 + q3)*sin(b2)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  -l*mf*(l*sin(b1 + q3) - (h*sin(b2 + q3))/2 + (h*sin(b2 - q3))/2)];
M(:,6) =[                                                                                                                                                                                                                                                                                                                                                                                                                                                        mp*(sin(q1)*sin(q3) + cos(q1)*cos(q3)*sin(q2))*(a/2 + (b*sin(gama2))/2) - mp*(sin(q1)*sin(q3) + cos(q1)*cos(q3)*sin(q2))*(a/2 + (b*sin(gama1))/2) - mf*(h - l*cos(b1)*cos(b2))*(sin(q1)*sin(q3) + cos(q1)*cos(q3)*sin(q2)) + l*mf*cos(b2)*sin(b1)*(cos(q3)*sin(q1) - cos(q1)*sin(q2)*sin(q3))
                                                                                                                                                                                                                                                                                                                                                                                                                                                        mf*(h - l*cos(b1)*cos(b2))*(cos(q1)*sin(q3) - cos(q3)*sin(q1)*sin(q2)) + mp*(cos(q1)*sin(q3) - cos(q3)*sin(q1)*sin(q2))*(a/2 + (b*sin(gama1))/2) - mp*(cos(q1)*sin(q3) - cos(q3)*sin(q1)*sin(q2))*(a/2 + (b*sin(gama2))/2) - l*mf*cos(b2)*sin(b1)*(cos(q1)*cos(q3) + sin(q1)*sin(q2)*sin(q3))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  -(cos(q2)*(2*h*mf*cos(q3) + b*mp*cos(q3)*sin(gama1) - b*mp*cos(q3)*sin(gama2) - 2*l*mf*cos(b1)*cos(b2)*cos(q3) + 2*l*mf*cos(b2)*sin(b1)*sin(q3)))/2
 (b^2*mp*cos(gama1)^2*sin(q2))/3 - Ixz*cos(q2)*cos(q3) - Ixy*cos(q2)*sin(q3) - (a^2*mp*sin(q2))/2 - (2*b^2*mp*sin(q2))/3 - (c^2*mp*sin(q2))/6 - h^2*mf*sin(q2) - Ixx*sin(q2) + (b^2*mp*cos(gama2)^2*sin(q2))/3 - l^2*mf*cos(b2)^2*sin(q2) + (b^2*mp*cos(q2)*sin(gama1)*sin(q3))/4 - (b^2*mp*cos(q2)*sin(gama2)*sin(q3))/4 - (a*b*mp*sin(gama1)*sin(q2))/2 - (a*b*mp*sin(gama2)*sin(q2))/2 + 2*h*l*mf*cos(b1)*cos(b2)*sin(q2) - (a*b*mp*cos(gama1)*cos(q2)*sin(q3))/4 + (a*b*mp*cos(gama2)*cos(q2)*sin(q3))/4 - h*l*mf*cos(q2)*sin(b2)*sin(q3) - (b^2*mp*cos(gama1)*cos(q2)*sin(gama1)*sin(q3))/3 + (b^2*mp*cos(gama2)*cos(q2)*sin(gama2)*sin(q3))/3 + l^2*mf*cos(b1)*cos(b2)*cos(q2)*sin(b2)*sin(q3) + l^2*mf*cos(b2)*cos(q2)*cos(q3)*sin(b1)*sin(b2)
                                                                                                                                                                                                                                                                                                                                                                                                                 Ixz*sin(q3) - Ixy*cos(q3) + (b^2*mp*cos(q3)*sin(gama1))/4 - (b^2*mp*cos(q3)*sin(gama2))/4 - (b^2*mp*sin(2*gama1)*cos(q3))/6 + (b^2*mp*sin(2*gama2)*cos(q3))/6 - (a*b*mp*cos(gama1)*cos(q3))/4 + (a*b*mp*cos(gama2)*cos(q3))/4 - h*l*mf*cos(q3)*sin(b2) + (l^2*mf*sin(2*b2)*cos(b1)*cos(q3))/2 - (l^2*mf*sin(2*b2)*sin(b1)*sin(q3))/2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Ixx + (a^2*mp)/2 + (2*b^2*mp)/3 + (c^2*mp)/6 + h^2*mf - (b^2*mp*cos(gama1)^2)/3 - (b^2*mp*cos(gama2)^2)/3 + l^2*mf*cos(b2)^2 + (a*b*mp*sin(gama1))/2 + (a*b*mp*sin(gama2))/2 - 2*h*l*mf*cos(b1)*cos(b2)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        -l*mf*(h*cos(b1) - l*cos(b2))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               h*l*mf*sin(b1)*sin(b2)];
M(:,7) =[(b*mp*cos(gama1)*(cos(q3)*sin(q1) - cos(q1)*sin(q2)*sin(q3)))/2 + (b*mp*cos(q1)*cos(q2)*sin(gama1))/2
 (b*mp*cos(q2)*sin(gama1)*sin(q1))/2 - (b*mp*cos(gama1)*(cos(q1)*cos(q3) + sin(q1)*sin(q2)*sin(q3)))/2
                                           -(b*mp*(sin(gama1)*sin(q2) + cos(gama1)*cos(q2)*sin(q3)))/2
                                     (b*mp*cos(q2)*cos(q3)*(4*b - 3*b*cos(gama1) + 3*a*sin(gama1)))/12
                                            -(b*mp*sin(q3)*(4*b - 3*b*cos(gama1) + 3*a*sin(gama1)))/12
                                                                                                     0
                                                                                            (b^2*mp)/3
                                                                                                     0
                                                                                                     0
                                                                                                     0];
M(:,8) =[(b*mp*cos(q1)*cos(q2)*sin(gama2))/2 - (b*mp*cos(gama2)*(cos(q3)*sin(q1) - cos(q1)*sin(q2)*sin(q3)))/2
 (b*mp*cos(gama2)*(cos(q1)*cos(q3) + sin(q1)*sin(q2)*sin(q3)))/2 + (b*mp*cos(q2)*sin(gama2)*sin(q1))/2
                                           -(b*mp*(sin(gama2)*sin(q2) - cos(gama2)*cos(q2)*sin(q3)))/2
                                    -(b*mp*cos(q2)*cos(q3)*(4*b - 3*b*cos(gama2) + 3*a*sin(gama2)))/12
                                             (b*mp*sin(q3)*(4*b - 3*b*cos(gama2) + 3*a*sin(gama2)))/12
                                                                                                     0
                                                                                                     0
                                                                                            (b^2*mp)/3
                                                                                                     0
                                                                                                     0];
M(:,9) =[ l*mf*(cos(b1)*sin(q1)*sin(q3) + cos(q3)*sin(b1)*sin(q1) + cos(b1)*cos(q1)*cos(q3)*sin(q2) - cos(q1)*sin(b1)*sin(q2)*sin(q3))
 -l*mf*(cos(b1)*cos(q1)*sin(q3) + cos(q1)*cos(q3)*sin(b1) - cos(b1)*cos(q3)*sin(q1)*sin(q2) + sin(b1)*sin(q1)*sin(q2)*sin(q3))
                                                                                                     l*mf*cos(b1 + q3)*cos(q2)
          l*mf*(h*cos(b1)*sin(q2) - l*cos(b2)*sin(q2) + l*cos(b1)*cos(q2)*sin(b2)*sin(q3) + l*cos(q2)*cos(q3)*sin(b1)*sin(b2))
                                                                                                   l^2*mf*cos(b1 + q3)*sin(b2)
                                                                                                 -l*mf*(h*cos(b1) - l*cos(b2))
                                                                                                                             0
                                                                                                                             0
                                                                                                                        l^2*mf
                                                                                                                             0];
M(:,10)=[l*mf*cos(b1)*sin(b2)*(cos(q3)*sin(q1) - cos(q1)*sin(q2)*sin(q3)) - l*mf*sin(b1)*sin(b2)*(sin(q1)*sin(q3) + cos(q1)*cos(q3)*sin(q2)) - l*mf*cos(b2)*cos(q1)*cos(q2)
 l*mf*sin(b1)*sin(b2)*(cos(q1)*sin(q3) - cos(q3)*sin(q1)*sin(q2)) - l*mf*cos(b1)*sin(b2)*(cos(q1)*cos(q3) + sin(q1)*sin(q2)*sin(q3)) - l*mf*cos(b2)*cos(q2)*sin(q1)
                                                                        -l*mf*(cos(b1)*cos(q2)*sin(b2)*sin(q3) - cos(b2)*sin(q2) + cos(q2)*cos(q3)*sin(b1)*sin(b2))
                                              -l*mf*(h*cos(b2)*cos(q2)*cos(q3) - l*cos(b1)*cos(q2)*cos(q3) + h*sin(b1)*sin(b2)*sin(q2) + l*cos(q2)*sin(b1)*sin(q3))
                                                                                                   -l*mf*(l*sin(b1 + q3) - (h*sin(b2 + q3))/2 + (h*sin(b2 - q3))/2)
                                                                                                                                             h*l*mf*sin(b1)*sin(b2)
                                                                                                                                                                  0
                                                                                                                                                                  0
                                                                                                                                                                  0
                                                                                                                                                             l^2*mf];


B1 =(b*dgama1^2*mp*cos(gama1)*cos(q1)*cos(q2))/2 - b*dq2^2*mp*cos(q1)*cos(q2) - dq1^2*h*mf*cos(q3)*sin(q1) - dq3^2*h*mf*cos(q3)*sin(q1) - b*dq1^2*mp*cos(q1)*cos(q2) + (b*dgama2^2*mp*cos(gama2)*cos(q1)*cos(q2))/2 + (b*dq1^2*mp*cos(gama1)*cos(q1)*cos(q2))/2 + (b*dq1^2*mp*cos(gama2)*cos(q1)*cos(q2))/2 + (b*dq2^2*mp*cos(gama1)*cos(q1)*cos(q2))/2 + (b*dq2^2*mp*cos(gama2)*cos(q1)*cos(q2))/2 + db1^2*l*mf*cos(b1)*cos(q3)*sin(q1) + db2^2*l*mf*cos(q1)*cos(q2)*sin(b2) + dq1^2*l*mf*cos(q1)*cos(q2)*sin(b2) + dq2^2*l*mf*cos(q1)*cos(q2)*sin(b2) - (b*dgama1^2*mp*cos(q3)*sin(gama1)*sin(q1))/2 + (b*dgama2^2*mp*cos(q3)*sin(gama2)*sin(q1))/2 - (b*dq1^2*mp*cos(q3)*sin(gama1)*sin(q1))/2 + (b*dq1^2*mp*cos(q3)*sin(gama2)*sin(q1))/2 - (b*dq3^2*mp*cos(q3)*sin(gama1)*sin(q1))/2 + (b*dq3^2*mp*cos(q3)*sin(gama2)*sin(q1))/2 + dq1^2*h*mf*cos(q1)*sin(q2)*sin(q3) + dq2^2*h*mf*cos(q1)*sin(q2)*sin(q3) + dq3^2*h*mf*cos(q1)*sin(q2)*sin(q3) - db1^2*l*mf*sin(b1)*sin(q1)*sin(q3) - 2*dq1*dq3*h*mf*cos(q1)*sin(q3) + 2*b*dq1*dq2*mp*sin(q1)*sin(q2) + db2^2*l*mf*cos(b1)*cos(b2)*cos(q3)*sin(q1) + dq1^2*l*mf*cos(b1)*cos(b2)*cos(q3)*sin(q1) + dq3^2*l*mf*cos(b1)*cos(b2)*cos(q3)*sin(q1) - db1^2*l*mf*cos(b1)*cos(q1)*sin(q2)*sin(q3) - db1^2*l*mf*cos(q1)*cos(q3)*sin(b1)*sin(q2) - db2^2*l*mf*cos(b2)*sin(b1)*sin(q1)*sin(q3) - dq1^2*l*mf*cos(b2)*sin(b1)*sin(q1)*sin(q3) - dq3^2*l*mf*cos(b2)*sin(b1)*sin(q1)*sin(q3) + (b*dgama1^2*mp*cos(q1)*sin(gama1)*sin(q2)*sin(q3))/2 - (b*dgama2^2*mp*cos(q1)*sin(gama2)*sin(q2)*sin(q3))/2 + (b*dq1^2*mp*cos(q1)*sin(gama1)*sin(q2)*sin(q3))/2 - (b*dq1^2*mp*cos(q1)*sin(gama2)*sin(q2)*sin(q3))/2 + (b*dq2^2*mp*cos(q1)*sin(gama1)*sin(q2)*sin(q3))/2 - (b*dq2^2*mp*cos(q1)*sin(gama2)*sin(q2)*sin(q3))/2 + (b*dq3^2*mp*cos(q1)*sin(gama1)*sin(q2)*sin(q3))/2 - (b*dq3^2*mp*cos(q1)*sin(gama2)*sin(q2)*sin(q3))/2 + b*dgama1*dq1*mp*cos(gama1)*cos(q1)*cos(q3) - b*dgama2*dq1*mp*cos(gama2)*cos(q1)*cos(q3) - 2*dq2*dq3*h*mf*cos(q1)*cos(q2)*cos(q3) + db1*dq1*l*mf*cos(b1)*cos(q1)*sin(q3) + db1*dq1*l*mf*cos(q1)*cos(q3)*sin(b1) + 2*db2*dq1*l*mf*cos(b2)*cos(q2)*sin(q1) + db1*dq3*l*mf*cos(b1)*cos(q3)*sin(q1) + 2*db2*dq2*l*mf*cos(b2)*cos(q1)*sin(q2) - b*dgama1*dq1*mp*cos(q2)*sin(gama1)*sin(q1) - b*dgama1*dq2*mp*cos(q1)*sin(gama1)*sin(q2) - b*dgama2*dq1*mp*cos(q2)*sin(gama2)*sin(q1) - b*dgama1*dq3*mp*cos(gama1)*sin(q1)*sin(q3) - b*dgama2*dq2*mp*cos(q1)*sin(gama2)*sin(q2) + b*dgama2*dq3*mp*cos(gama2)*sin(q1)*sin(q3) - b*dq1*dq2*mp*cos(gama1)*sin(q1)*sin(q2) - b*dq1*dq2*mp*cos(gama2)*sin(q1)*sin(q2) - b*dq1*dq3*mp*cos(q1)*sin(gama1)*sin(q3) + b*dq1*dq3*mp*cos(q1)*sin(gama2)*sin(q3) + 2*dq1*dq2*h*mf*cos(q2)*sin(q1)*sin(q3) + 2*dq1*dq3*h*mf*cos(q3)*sin(q1)*sin(q2) - db1*dq3*l*mf*sin(b1)*sin(q1)*sin(q3) - 2*dq1*dq2*l*mf*sin(b2)*sin(q1)*sin(q2) - db2^2*l*mf*cos(b1)*cos(b2)*cos(q1)*sin(q2)*sin(q3) - db2^2*l*mf*cos(b2)*cos(q1)*cos(q3)*sin(b1)*sin(q2) - dq1^2*l*mf*cos(b1)*cos(b2)*cos(q1)*sin(q2)*sin(q3) - dq1^2*l*mf*cos(b2)*cos(q1)*cos(q3)*sin(b1)*sin(q2) - dq2^2*l*mf*cos(b1)*cos(b2)*cos(q1)*sin(q2)*sin(q3) - dq2^2*l*mf*cos(b2)*cos(q1)*cos(q3)*sin(b1)*sin(q2) - dq3^2*l*mf*cos(b1)*cos(b2)*cos(q1)*sin(q2)*sin(q3) - dq3^2*l*mf*cos(b2)*cos(q1)*cos(q3)*sin(b1)*sin(q2) + db1*dq2*l*mf*cos(b1)*cos(q1)*cos(q2)*cos(q3) + db1*dq1*l*mf*cos(b1)*cos(b2)*cos(q1)*sin(q3) + db1*dq1*l*mf*cos(b2)*cos(q1)*cos(q3)*sin(b1) + 2*db2*dq1*l*mf*cos(b1)*cos(q1)*cos(q3)*sin(b2) + db1*dq3*l*mf*cos(b1)*cos(b2)*cos(q3)*sin(q1) + 2*dq1*dq3*l*mf*cos(b1)*cos(b2)*cos(q1)*sin(q3) + 2*dq1*dq3*l*mf*cos(b2)*cos(q1)*cos(q3)*sin(b1) - b*dgama1*dq2*mp*cos(gama1)*cos(q1)*cos(q2)*sin(q3) - b*dgama1*dq3*mp*cos(gama1)*cos(q1)*cos(q3)*sin(q2) + b*dgama2*dq2*mp*cos(gama2)*cos(q1)*cos(q2)*sin(q3) + b*dgama2*dq3*mp*cos(gama2)*cos(q1)*cos(q3)*sin(q2) - b*dq2*dq3*mp*cos(q1)*cos(q2)*cos(q3)*sin(gama1) + b*dq2*dq3*mp*cos(q1)*cos(q2)*cos(q3)*sin(gama2) - db1*dq1*l*mf*cos(b1)*cos(q3)*sin(q1)*sin(q2) - db1*dq2*l*mf*cos(q1)*cos(q2)*sin(b1)*sin(q3) - db1*dq3*l*mf*cos(b1)*cos(q1)*sin(q2)*sin(q3) - db1*dq3*l*mf*cos(q1)*cos(q3)*sin(b1)*sin(q2) - db1*db2*l*mf*cos(b1)*sin(b2)*sin(q1)*sin(q3) - db1*db2*l*mf*cos(q3)*sin(b1)*sin(b2)*sin(q1) - 2*db2*dq1*l*mf*cos(q1)*sin(b1)*sin(b2)*sin(q3) - db1*dq3*l*mf*cos(b2)*sin(b1)*sin(q1)*sin(q3) - 2*db2*dq3*l*mf*cos(b1)*sin(b2)*sin(q1)*sin(q3) - 2*db2*dq3*l*mf*cos(q3)*sin(b1)*sin(b2)*sin(q1) + b*dgama1*dq1*mp*cos(gama1)*sin(q1)*sin(q2)*sin(q3) - b*dgama2*dq1*mp*cos(gama2)*sin(q1)*sin(q2)*sin(q3) + b*dq1*dq2*mp*cos(q2)*sin(gama1)*sin(q1)*sin(q3) - b*dq1*dq2*mp*cos(q2)*sin(gama2)*sin(q1)*sin(q3) + b*dq1*dq3*mp*cos(q3)*sin(gama1)*sin(q1)*sin(q2) - b*dq1*dq3*mp*cos(q3)*sin(gama2)*sin(q1)*sin(q2) + db1*dq1*l*mf*sin(b1)*sin(q1)*sin(q2)*sin(q3) + db1*dq2*l*mf*cos(b1)*cos(b2)*cos(q1)*cos(q2)*cos(q3) + 2*dq2*dq3*l*mf*cos(b1)*cos(b2)*cos(q1)*cos(q2)*cos(q3) - db1*db2*l*mf*cos(b1)*cos(q1)*cos(q3)*sin(b2)*sin(q2) - db1*dq1*l*mf*cos(b1)*cos(b2)*cos(q3)*sin(q1)*sin(q2) - db1*dq2*l*mf*cos(b2)*cos(q1)*cos(q2)*sin(b1)*sin(q3) - db1*dq3*l*mf*cos(b1)*cos(b2)*cos(q1)*sin(q2)*sin(q3) - db1*dq3*l*mf*cos(b2)*cos(q1)*cos(q3)*sin(b1)*sin(q2) - 2*db2*dq2*l*mf*cos(b1)*cos(q1)*cos(q2)*sin(b2)*sin(q3) - 2*db2*dq2*l*mf*cos(q1)*cos(q2)*cos(q3)*sin(b1)*sin(b2) - 2*db2*dq3*l*mf*cos(b1)*cos(q1)*cos(q3)*sin(b2)*sin(q2) - 2*dq1*dq2*l*mf*cos(b1)*cos(b2)*cos(q2)*sin(q1)*sin(q3) - 2*dq1*dq2*l*mf*cos(b2)*cos(q2)*cos(q3)*sin(b1)*sin(q1) - 2*dq1*dq3*l*mf*cos(b1)*cos(b2)*cos(q3)*sin(q1)*sin(q2) - 2*dq2*dq3*l*mf*cos(b2)*cos(q1)*cos(q2)*sin(b1)*sin(q3) + db1*db2*l*mf*cos(q1)*sin(b1)*sin(b2)*sin(q2)*sin(q3) + db1*dq1*l*mf*cos(b2)*sin(b1)*sin(q1)*sin(q2)*sin(q3) + 2*db2*dq1*l*mf*cos(b1)*sin(b2)*sin(q1)*sin(q2)*sin(q3) + 2*db2*dq1*l*mf*cos(q3)*sin(b1)*sin(b2)*sin(q1)*sin(q2) + 2*db2*dq3*l*mf*cos(q1)*sin(b1)*sin(b2)*sin(q2)*sin(q3) + 2*dq1*dq3*l*mf*cos(b2)*sin(b1)*sin(q1)*sin(q2)*sin(q3);
B2 =dq1^2*h*mf*cos(q1)*cos(q3) + dq3^2*h*mf*cos(q1)*cos(q3) - b*dq1^2*mp*cos(q2)*sin(q1) - b*dq2^2*mp*cos(q2)*sin(q1) - db1^2*l*mf*cos(b1)*cos(q1)*cos(q3) + (b*dgama1^2*mp*cos(gama1)*cos(q2)*sin(q1))/2 + (b*dgama1^2*mp*cos(q1)*cos(q3)*sin(gama1))/2 + (b*dgama2^2*mp*cos(gama2)*cos(q2)*sin(q1))/2 - (b*dgama2^2*mp*cos(q1)*cos(q3)*sin(gama2))/2 + (b*dq1^2*mp*cos(gama1)*cos(q2)*sin(q1))/2 + (b*dq1^2*mp*cos(gama2)*cos(q2)*sin(q1))/2 + (b*dq1^2*mp*cos(q1)*cos(q3)*sin(gama1))/2 + (b*dq2^2*mp*cos(gama1)*cos(q2)*sin(q1))/2 - (b*dq1^2*mp*cos(q1)*cos(q3)*sin(gama2))/2 + (b*dq2^2*mp*cos(gama2)*cos(q2)*sin(q1))/2 + (b*dq3^2*mp*cos(q1)*cos(q3)*sin(gama1))/2 - (b*dq3^2*mp*cos(q1)*cos(q3)*sin(gama2))/2 + db1^2*l*mf*cos(q1)*sin(b1)*sin(q3) + db2^2*l*mf*cos(q2)*sin(b2)*sin(q1) + dq1^2*l*mf*cos(q2)*sin(b2)*sin(q1) + dq2^2*l*mf*cos(q2)*sin(b2)*sin(q1) + dq1^2*h*mf*sin(q1)*sin(q2)*sin(q3) + dq2^2*h*mf*sin(q1)*sin(q2)*sin(q3) + dq3^2*h*mf*sin(q1)*sin(q2)*sin(q3) - 2*b*dq1*dq2*mp*cos(q1)*sin(q2) - 2*dq1*dq3*h*mf*sin(q1)*sin(q3) - db2^2*l*mf*cos(b1)*cos(b2)*cos(q1)*cos(q3) - dq1^2*l*mf*cos(b1)*cos(b2)*cos(q1)*cos(q3) - dq3^2*l*mf*cos(b1)*cos(b2)*cos(q1)*cos(q3) + db2^2*l*mf*cos(b2)*cos(q1)*sin(b1)*sin(q3) + dq1^2*l*mf*cos(b2)*cos(q1)*sin(b1)*sin(q3) + dq3^2*l*mf*cos(b2)*cos(q1)*sin(b1)*sin(q3) - db1^2*l*mf*cos(b1)*sin(q1)*sin(q2)*sin(q3) - db1^2*l*mf*cos(q3)*sin(b1)*sin(q1)*sin(q2) - 2*db2*dq1*l*mf*cos(b2)*cos(q1)*cos(q2) - db1*dq3*l*mf*cos(b1)*cos(q1)*cos(q3) + (b*dgama1^2*mp*sin(gama1)*sin(q1)*sin(q2)*sin(q3))/2 - (b*dgama2^2*mp*sin(gama2)*sin(q1)*sin(q2)*sin(q3))/2 + (b*dq1^2*mp*sin(gama1)*sin(q1)*sin(q2)*sin(q3))/2 - (b*dq1^2*mp*sin(gama2)*sin(q1)*sin(q2)*sin(q3))/2 + (b*dq2^2*mp*sin(gama1)*sin(q1)*sin(q2)*sin(q3))/2 - (b*dq2^2*mp*sin(gama2)*sin(q1)*sin(q2)*sin(q3))/2 + (b*dq3^2*mp*sin(gama1)*sin(q1)*sin(q2)*sin(q3))/2 - (b*dq3^2*mp*sin(gama2)*sin(q1)*sin(q2)*sin(q3))/2 + b*dgama1*dq1*mp*cos(q1)*cos(q2)*sin(gama1) + b*dgama1*dq1*mp*cos(gama1)*cos(q3)*sin(q1) + b*dgama2*dq1*mp*cos(q1)*cos(q2)*sin(gama2) + b*dgama1*dq3*mp*cos(gama1)*cos(q1)*sin(q3) - b*dgama2*dq1*mp*cos(gama2)*cos(q3)*sin(q1) - b*dgama2*dq3*mp*cos(gama2)*cos(q1)*sin(q3) + b*dq1*dq2*mp*cos(gama1)*cos(q1)*sin(q2) + b*dq1*dq2*mp*cos(gama2)*cos(q1)*sin(q2) - 2*dq1*dq2*h*mf*cos(q1)*cos(q2)*sin(q3) - 2*dq1*dq3*h*mf*cos(q1)*cos(q3)*sin(q2) - 2*dq2*dq3*h*mf*cos(q2)*cos(q3)*sin(q1) + db1*dq1*l*mf*cos(b1)*sin(q1)*sin(q3) + db1*dq1*l*mf*cos(q3)*sin(b1)*sin(q1) + db1*dq3*l*mf*cos(q1)*sin(b1)*sin(q3) + 2*db2*dq2*l*mf*cos(b2)*sin(q1)*sin(q2) + 2*dq1*dq2*l*mf*cos(q1)*sin(b2)*sin(q2) - b*dgama1*dq2*mp*sin(gama1)*sin(q1)*sin(q2) - b*dgama2*dq2*mp*sin(gama2)*sin(q1)*sin(q2) - b*dq1*dq3*mp*sin(gama1)*sin(q1)*sin(q3) + b*dq1*dq3*mp*sin(gama2)*sin(q1)*sin(q3) - db2^2*l*mf*cos(b1)*cos(b2)*sin(q1)*sin(q2)*sin(q3) - db2^2*l*mf*cos(b2)*cos(q3)*sin(b1)*sin(q1)*sin(q2) - dq1^2*l*mf*cos(b1)*cos(b2)*sin(q1)*sin(q2)*sin(q3) - dq1^2*l*mf*cos(b2)*cos(q3)*sin(b1)*sin(q1)*sin(q2) - dq2^2*l*mf*cos(b1)*cos(b2)*sin(q1)*sin(q2)*sin(q3) - dq2^2*l*mf*cos(b2)*cos(q3)*sin(b1)*sin(q1)*sin(q2) - dq3^2*l*mf*cos(b1)*cos(b2)*sin(q1)*sin(q2)*sin(q3) - dq3^2*l*mf*cos(b2)*cos(q3)*sin(b1)*sin(q1)*sin(q2) - db1*dq3*l*mf*cos(b1)*cos(b2)*cos(q1)*cos(q3) + db1*dq1*l*mf*cos(b1)*cos(q1)*cos(q3)*sin(q2) + db1*dq2*l*mf*cos(b1)*cos(q2)*cos(q3)*sin(q1) + db1*db2*l*mf*cos(b1)*cos(q1)*sin(b2)*sin(q3) + db1*db2*l*mf*cos(q1)*cos(q3)*sin(b1)*sin(b2) + db1*dq1*l*mf*cos(b1)*cos(b2)*sin(q1)*sin(q3) + db1*dq1*l*mf*cos(b2)*cos(q3)*sin(b1)*sin(q1) + 2*db2*dq1*l*mf*cos(b1)*cos(q3)*sin(b2)*sin(q1) + db1*dq3*l*mf*cos(b2)*cos(q1)*sin(b1)*sin(q3) + 2*db2*dq3*l*mf*cos(b1)*cos(q1)*sin(b2)*sin(q3) + 2*db2*dq3*l*mf*cos(q1)*cos(q3)*sin(b1)*sin(b2) + 2*dq1*dq3*l*mf*cos(b1)*cos(b2)*sin(q1)*sin(q3) + 2*dq1*dq3*l*mf*cos(b2)*cos(q3)*sin(b1)*sin(q1) - b*dgama1*dq1*mp*cos(gama1)*cos(q1)*sin(q2)*sin(q3) - b*dgama1*dq2*mp*cos(gama1)*cos(q2)*sin(q1)*sin(q3) - b*dgama1*dq3*mp*cos(gama1)*cos(q3)*sin(q1)*sin(q2) + b*dgama2*dq1*mp*cos(gama2)*cos(q1)*sin(q2)*sin(q3) + b*dgama2*dq2*mp*cos(gama2)*cos(q2)*sin(q1)*sin(q3) + b*dgama2*dq3*mp*cos(gama2)*cos(q3)*sin(q1)*sin(q2) - b*dq1*dq2*mp*cos(q1)*cos(q2)*sin(gama1)*sin(q3) + b*dq1*dq2*mp*cos(q1)*cos(q2)*sin(gama2)*sin(q3) - b*dq1*dq3*mp*cos(q1)*cos(q3)*sin(gama1)*sin(q2) + b*dq1*dq3*mp*cos(q1)*cos(q3)*sin(gama2)*sin(q2) - b*dq2*dq3*mp*cos(q2)*cos(q3)*sin(gama1)*sin(q1) + b*dq2*dq3*mp*cos(q2)*cos(q3)*sin(gama2)*sin(q1) - db1*dq1*l*mf*cos(q1)*sin(b1)*sin(q2)*sin(q3) - db1*dq2*l*mf*cos(q2)*sin(b1)*sin(q1)*sin(q3) - db1*dq3*l*mf*cos(b1)*sin(q1)*sin(q2)*sin(q3) - db1*dq3*l*mf*cos(q3)*sin(b1)*sin(q1)*sin(q2) - 2*db2*dq1*l*mf*sin(b1)*sin(b2)*sin(q1)*sin(q3) + db1*dq1*l*mf*cos(b1)*cos(b2)*cos(q1)*cos(q3)*sin(q2) + db1*dq2*l*mf*cos(b1)*cos(b2)*cos(q2)*cos(q3)*sin(q1) + 2*dq1*dq2*l*mf*cos(b1)*cos(b2)*cos(q1)*cos(q2)*sin(q3) + 2*dq1*dq2*l*mf*cos(b2)*cos(q1)*cos(q2)*cos(q3)*sin(b1) + 2*dq1*dq3*l*mf*cos(b1)*cos(b2)*cos(q1)*cos(q3)*sin(q2) + 2*dq2*dq3*l*mf*cos(b1)*cos(b2)*cos(q2)*cos(q3)*sin(q1) - db1*db2*l*mf*cos(b1)*cos(q3)*sin(b2)*sin(q1)*sin(q2) - db1*dq1*l*mf*cos(b2)*cos(q1)*sin(b1)*sin(q2)*sin(q3) - db1*dq2*l*mf*cos(b2)*cos(q2)*sin(b1)*sin(q1)*sin(q3) - 2*db2*dq1*l*mf*cos(b1)*cos(q1)*sin(b2)*sin(q2)*sin(q3) - 2*db2*dq1*l*mf*cos(q1)*cos(q3)*sin(b1)*sin(b2)*sin(q2) - db1*dq3*l*mf*cos(b1)*cos(b2)*sin(q1)*sin(q2)*sin(q3) - db1*dq3*l*mf*cos(b2)*cos(q3)*sin(b1)*sin(q1)*sin(q2) - 2*db2*dq2*l*mf*cos(b1)*cos(q2)*sin(b2)*sin(q1)*sin(q3) - 2*db2*dq2*l*mf*cos(q2)*cos(q3)*sin(b1)*sin(b2)*sin(q1) - 2*db2*dq3*l*mf*cos(b1)*cos(q3)*sin(b2)*sin(q1)*sin(q2) - 2*dq1*dq3*l*mf*cos(b2)*cos(q1)*sin(b1)*sin(q2)*sin(q3) - 2*dq2*dq3*l*mf*cos(b2)*cos(q2)*sin(b1)*sin(q1)*sin(q3) + db1*db2*l*mf*sin(b1)*sin(b2)*sin(q1)*sin(q2)*sin(q3) + 2*db2*dq3*l*mf*sin(b1)*sin(b2)*sin(q1)*sin(q2)*sin(q3);
B3 =b*dq2^2*mp*sin(q2) - (b*dgama1^2*mp*cos(gama1)*sin(q2))/2 - (b*dgama2^2*mp*cos(gama2)*sin(q2))/2 - (b*dq2^2*mp*cos(gama1)*sin(q2))/2 - (b*dq2^2*mp*cos(gama2)*sin(q2))/2 + dq2^2*h*mf*cos(q2)*sin(q3) + dq3^2*h*mf*cos(q2)*sin(q3) - db2^2*l*mf*sin(b2)*sin(q2) - dq2^2*l*mf*sin(b2)*sin(q2) - db1^2*l*mf*cos(b1)*cos(q2)*sin(q3) - db1^2*l*mf*cos(q2)*cos(q3)*sin(b1) + (b*dgama1^2*mp*cos(q2)*sin(gama1)*sin(q3))/2 - (b*dgama2^2*mp*cos(q2)*sin(gama2)*sin(q3))/2 + (b*dq2^2*mp*cos(q2)*sin(gama1)*sin(q3))/2 - (b*dq2^2*mp*cos(q2)*sin(gama2)*sin(q3))/2 + (b*dq3^2*mp*cos(q2)*sin(gama1)*sin(q3))/2 - (b*dq3^2*mp*cos(q2)*sin(gama2)*sin(q3))/2 + 2*db2*dq2*l*mf*cos(b2)*cos(q2) - b*dgama1*dq2*mp*cos(q2)*sin(gama1) - b*dgama2*dq2*mp*cos(q2)*sin(gama2) + 2*dq2*dq3*h*mf*cos(q3)*sin(q2) - db2^2*l*mf*cos(b1)*cos(b2)*cos(q2)*sin(q3) - db2^2*l*mf*cos(b2)*cos(q2)*cos(q3)*sin(b1) - dq2^2*l*mf*cos(b1)*cos(b2)*cos(q2)*sin(q3) - dq2^2*l*mf*cos(b2)*cos(q2)*cos(q3)*sin(b1) - dq3^2*l*mf*cos(b1)*cos(b2)*cos(q2)*sin(q3) - dq3^2*l*mf*cos(b2)*cos(q2)*cos(q3)*sin(b1) - b*dgama1*dq3*mp*cos(gama1)*cos(q2)*cos(q3) + b*dgama2*dq3*mp*cos(gama2)*cos(q2)*cos(q3) - db1*dq2*l*mf*cos(b1)*cos(q3)*sin(q2) - db1*dq3*l*mf*cos(b1)*cos(q2)*sin(q3) - db1*dq3*l*mf*cos(q2)*cos(q3)*sin(b1) + b*dgama1*dq2*mp*cos(gama1)*sin(q2)*sin(q3) - b*dgama2*dq2*mp*cos(gama2)*sin(q2)*sin(q3) + b*dq2*dq3*mp*cos(q3)*sin(gama1)*sin(q2) - b*dq2*dq3*mp*cos(q3)*sin(gama2)*sin(q2) + db1*dq2*l*mf*sin(b1)*sin(q2)*sin(q3) - db1*db2*l*mf*cos(b1)*cos(q2)*cos(q3)*sin(b2) - db1*dq2*l*mf*cos(b1)*cos(b2)*cos(q3)*sin(q2) - db1*dq3*l*mf*cos(b1)*cos(b2)*cos(q2)*sin(q3) - db1*dq3*l*mf*cos(b2)*cos(q2)*cos(q3)*sin(b1) - 2*db2*dq3*l*mf*cos(b1)*cos(q2)*cos(q3)*sin(b2) - 2*dq2*dq3*l*mf*cos(b1)*cos(b2)*cos(q3)*sin(q2) + db1*db2*l*mf*cos(q2)*sin(b1)*sin(b2)*sin(q3) + db1*dq2*l*mf*cos(b2)*sin(b1)*sin(q2)*sin(q3) + 2*db2*dq2*l*mf*cos(b1)*sin(b2)*sin(q2)*sin(q3) + 2*db2*dq2*l*mf*cos(q3)*sin(b1)*sin(b2)*sin(q2) + 2*db2*dq3*l*mf*cos(q2)*sin(b1)*sin(b2)*sin(q3) + 2*dq2*dq3*l*mf*cos(b2)*sin(b1)*sin(q2)*sin(q3);
B4 =Ixy*dq2^2*cos(q2)*cos(q3) - Iyz*dq2^2*sin(q2) - Ixy*dq3^2*cos(q2)*cos(q3) - Ixz*dq2^2*cos(q2)*sin(q3) + Ixz*dq3^2*cos(q2)*sin(q3) - Ixx*dq2*dq3*cos(q2) - 2*Ixz*dq1*dq2*cos(q3) - Iyy*dq2*dq3*cos(q2) + Izz*dq2*dq3*cos(q2) - 2*Ixy*dq1*dq2*sin(q3) + 2*Iyz*dq2^2*cos(q3)^2*sin(q2) + 2*Iyz*dq1*dq3*cos(q2)^2 + Ixx*dq1*dq2*sin(2*q2) - Iyy*dq1*dq2*sin(2*q2) - Iyy*dq2^2*cos(q3)*sin(q2)*sin(q3) + Izz*dq2^2*cos(q3)*sin(q2)*sin(q3) - (c^2*dq2*dq3*mp*cos(q2))/3 + 4*Ixz*dq1*dq2*cos(q2)^2*cos(q3) + 2*Iyy*dq2*dq3*cos(q2)*cos(q3)^2 - 2*Izz*dq2*dq3*cos(q2)*cos(q3)^2 + 4*Ixy*dq1*dq2*cos(q2)^2*sin(q3) + (b^2*dgama1*dq1*mp*sin(2*gama1))/3 + (b^2*dgama2*dq1*mp*sin(2*gama2))/3 - db2*dq1*l^2*mf*sin(2*b2) + (a^2*dq1*dq2*mp*sin(2*q2))/2 + (b^2*dq1*dq2*mp*sin(2*q2))/6 + dq1*dq2*h^2*mf*sin(2*q2) - dq1*dq2*l^2*mf*sin(2*q2) - 4*Iyz*dq1*dq3*cos(q2)^2*cos(q3)^2 - 2*Ixz*dq1*dq3*cos(q2)*sin(q2)*sin(q3) - (2*b^2*dgama1*dq2*mp*cos(q3)*sin(q2))/3 + (2*b^2*dgama2*dq2*mp*cos(q3)*sin(q2))/3 + (b^2*dq1*dq2*mp*sin(gama1)*sin(q3))/2 - (b^2*dq1*dq2*mp*sin(gama2)*sin(q3))/2 + db1*db2*l^2*mf*sin(b2)*sin(q2) - db1^2*h*l*mf*sin(b1)*sin(q2) + (a*b*dgama1*dq1*mp*cos(gama1))/2 + (a*b*dgama2*dq1*mp*cos(gama2))/2 - db1*dq2*l^2*mf*cos(b2)^2*cos(q2) - 2*dq2*dq3*l^2*mf*cos(b2)^2*cos(q2) - a^2*dq2*dq3*mp*cos(q2)*cos(q3)^2 + 2*Iyy*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) + 2*Iyy*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3) - 2*Izz*dq1*dq2*cos(q2)*cos(q3)^2*sin(q2) - 2*Izz*dq1*dq3*cos(q2)^2*cos(q3)*sin(q3) - (4*b^2*dq2*dq3*mp*cos(q2)*cos(q3)^2)/3 + (c^2*dq2*dq3*mp*cos(q2)*cos(q3)^2)/3 - 2*dq2*dq3*h^2*mf*cos(q2)*cos(q3)^2 + (b^2*dgama1*dq1*mp*cos(q2)^2*sin(gama1))/2 + (b^2*dgama2*dq1*mp*cos(q2)^2*sin(gama2))/2 + (b^2*dgama1^2*mp*cos(q2)*cos(q3)*sin(gama1))/4 - (b^2*dgama2^2*mp*cos(q2)*cos(q3)*sin(gama2))/4 - (b^2*dq2^2*mp*cos(q2)*cos(q3)*sin(gama1))/4 + (b^2*dq2^2*mp*cos(q2)*cos(q3)*sin(gama2))/4 + (b^2*dq3^2*mp*cos(q2)*cos(q3)*sin(gama1))/4 - (b^2*dq3^2*mp*cos(q2)*cos(q3)*sin(gama2))/4 + (a^2*dq2^2*mp*cos(q3)*sin(q2)*sin(q3))/2 + (2*b^2*dq2^2*mp*cos(q3)*sin(q2)*sin(q3))/3 - (c^2*dq2^2*mp*cos(q3)*sin(q2)*sin(q3))/6 + dq2^2*h^2*mf*cos(q3)*sin(q2)*sin(q3) - db1*dq2*l^2*mf*cos(b2)*cos(q2) + 2*Ixy*dq1*dq3*cos(q2)*cos(q3)*sin(q2) + 4*Iyz*dq2*dq3*cos(q2)*cos(q3)*sin(q3) - dq2^2*l^2*mf*cos(b1)*cos(b2)^2*sin(b1)*sin(q2) + db1*dq2*h*l*mf*cos(b1)*cos(q2) + 2*db1*dq1*h*l*mf*cos(b2)*sin(b1) + 2*db2*dq1*h*l*mf*cos(b1)*sin(b2) - (a*b*dgama1*dq3*mp*cos(gama1)*sin(q2))/2 - (a*b*dgama2*dq3*mp*cos(gama2)*sin(q2))/2 - (a*b*dq1*dq2*mp*cos(gama1)*sin(q3))/2 + (a*b*dq1*dq2*mp*cos(gama2)*sin(q3))/2 - (b^2*dq2^2*mp*cos(gama1)^2*cos(q3)*sin(q2)*sin(q3))/3 - (b^2*dq2^2*mp*cos(gama2)^2*cos(q3)*sin(q2)*sin(q3))/3 - dq2^2*l^2*mf*cos(b2)^2*cos(q3)*sin(q2)*sin(q3) - 2*dq1*dq2*h*l*mf*sin(b2)*sin(q3) + 2*db2*dq1*l^2*mf*cos(b2)*cos(q2)^2*sin(b2) - (4*b^2*dgama1*dq1*mp*cos(gama1)*cos(q2)^2*sin(gama1))/3 - (4*b^2*dgama2*dq1*mp*cos(gama2)*cos(q2)^2*sin(gama2))/3 + (2*b^2*dgama1*dq2*mp*cos(gama1)^2*cos(q3)*sin(q2))/3 - (2*b^2*dgama1*dq3*mp*cos(gama1)^2*cos(q2)*sin(q3))/3 - (2*b^2*dgama2*dq2*mp*cos(gama2)^2*cos(q3)*sin(q2))/3 + (2*b^2*dgama2*dq3*mp*cos(gama2)^2*cos(q2)*sin(q3))/3 - (4*b^2*dq1*dq2*mp*cos(gama1)^2*cos(q2)*sin(q2))/3 - (4*b^2*dq1*dq2*mp*cos(gama2)^2*cos(q2)*sin(q2))/3 + 2*dq1*dq2*l^2*mf*cos(b2)^2*cos(q2)*sin(q2) - a^2*dq1*dq2*mp*cos(q2)*cos(q3)^2*sin(q2) - a^2*dq1*dq3*mp*cos(q2)^2*cos(q3)*sin(q3) - (4*b^2*dq1*dq2*mp*cos(q2)*cos(q3)^2*sin(q2))/3 - (4*b^2*dq1*dq3*mp*cos(q2)^2*cos(q3)*sin(q3))/3 + (c^2*dq1*dq2*mp*cos(q2)*cos(q3)^2*sin(q2))/3 + (c^2*dq1*dq3*mp*cos(q2)^2*cos(q3)*sin(q3))/3 - 2*dq1*dq2*h^2*mf*cos(q2)*cos(q3)^2*sin(q2) - 2*dq1*dq3*h^2*mf*cos(q2)^2*cos(q3)*sin(q3) - b^2*dq1*dq2*mp*cos(q2)^2*sin(gama1)*sin(q3) + b^2*dq1*dq2*mp*cos(q2)^2*sin(gama2)*sin(q3) - (a*b*dgama1*dq1*mp*cos(gama1)*cos(q2)^2)/2 - (a*b*dgama2*dq1*mp*cos(gama2)*cos(q2)^2)/2 + 2*db1*dq2*l^2*mf*cos(b1)^2*cos(b2)^2*cos(q2) + 2*dq2*dq3*l^2*mf*cos(b1)^2*cos(b2)^2*cos(q2) - dX*db1*l*mf*cos(b1)*cos(q1)*sin(q3) - dX*db1*l*mf*cos(q1)*cos(q3)*sin(b1) + (2*b^2*dq2*dq3*mp*cos(gama1)^2*cos(q2)*cos(q3)^2)/3 + (2*b^2*dq2*dq3*mp*cos(gama2)^2*cos(q2)*cos(q3)^2)/3 + 2*db1*dq2*l^2*mf*cos(b2)^2*cos(q2)*cos(q3)^2 + 2*dq2*dq3*l^2*mf*cos(b2)^2*cos(q2)*cos(q3)^2 - dY*db1*l*mf*cos(b1)*sin(q1)*sin(q3) - dY*db1*l*mf*cos(q3)*sin(b1)*sin(q1) + db1^2*l^2*mf*cos(b1)*cos(q2)*cos(q3)*sin(b2) + (b^2*dq2^2*mp*cos(gama1)*cos(q2)*cos(q3)*sin(gama1))/3 - (b^2*dq3^2*mp*cos(gama1)*cos(q2)*cos(q3)*sin(gama1))/3 - (b^2*dq2^2*mp*cos(gama2)*cos(q2)*cos(q3)*sin(gama2))/3 + (b^2*dq3^2*mp*cos(gama2)*cos(q2)*cos(q3)*sin(gama2))/3 - db1^2*l^2*mf*cos(q2)*sin(b1)*sin(b2)*sin(q3) + (a*b*dgama1^2*mp*cos(gama1)*cos(q2)*cos(q3))/4 - (a*b*dgama2^2*mp*cos(gama2)*cos(q2)*cos(q3))/4 + (a*b*dq2^2*mp*cos(gama1)*cos(q2)*cos(q3))/4 - (a*b*dq2^2*mp*cos(gama2)*cos(q2)*cos(q3))/4 - (a*b*dq3^2*mp*cos(gama1)*cos(q2)*cos(q3))/4 + (a*b*dq3^2*mp*cos(gama2)*cos(q2)*cos(q3))/4 + (b^2*dgama1*dq3*mp*cos(gama1)*cos(q2)*sin(q3))/2 - (b^2*dgama2*dq3*mp*cos(gama2)*cos(q2)*sin(q3))/2 + b^2*dq1*dq2*mp*cos(gama1)*cos(q2)*sin(q2) + b^2*dq1*dq2*mp*cos(gama2)*cos(q2)*sin(q2) - db1*db2*l^2*mf*cos(b1)*cos(q2)*sin(q3) - db1*db2*l^2*mf*cos(q2)*cos(q3)*sin(b1) - 2*db2*dq3*l^2*mf*cos(b1)*cos(q2)*sin(q3) - 2*db2*dq3*l^2*mf*cos(q2)*cos(q3)*sin(b1) + 2*db2*dq3*l^2*mf*cos(b2)*sin(b2)*sin(q2) - (2*b^2*dgama1*dq3*mp*cos(gama1)*sin(gama1)*sin(q2))/3 - (2*b^2*dgama2*dq3*mp*cos(gama2)*sin(gama2)*sin(q2))/3 - (2*b^2*dq1*dq2*mp*cos(gama1)*sin(gama1)*sin(q3))/3 + (2*b^2*dq1*dq2*mp*cos(gama2)*sin(gama2)*sin(q3))/3 + db2^2*h*l*mf*cos(q2)*cos(q3)*sin(b2) + dq2^2*h*l*mf*cos(q2)*cos(q3)*sin(b2) - dq3^2*h*l*mf*cos(q2)*cos(q3)*sin(b2) + 4*Iyz*dq1*dq2*cos(q2)*cos(q3)*sin(q2)*sin(q3) - db2^2*h*l*mf*cos(b2)*sin(b1)*sin(q2) + dq2^2*h*l*mf*cos(b2)*sin(b1)*sin(q2) - (2*b^2*dgama1*dq1*mp*cos(q2)*sin(q2)*sin(q3))/3 + (2*b^2*dgama2*dq1*mp*cos(q2)*sin(q2)*sin(q3))/3 - 2*db2*dq2*l^2*mf*cos(b1)*cos(b2)^2*cos(q3)*sin(q2) + 2*db2*dq3*l^2*mf*cos(b1)*cos(b2)^2*cos(q2)*sin(q3) + 2*db2*dq3*l^2*mf*cos(b2)^2*cos(q2)*cos(q3)*sin(b1) + (4*b^2*dq1*dq2*mp*cos(gama1)*cos(q2)^2*sin(gama1)*sin(q3))/3 - (4*b^2*dq1*dq2*mp*cos(gama2)*cos(q2)^2*sin(gama2)*sin(q3))/3 - 2*dq2^2*h*l*mf*cos(b2)*cos(q3)^2*sin(b1)*sin(q2) + (4*b^2*dgama1*dq1*mp*cos(gama1)^2*cos(q2)*sin(q2)*sin(q3))/3 - (4*b^2*dgama2*dq1*mp*cos(gama2)^2*cos(q2)*sin(q2)*sin(q3))/3 + 2*db2*dq2*l^2*mf*cos(b2)^2*sin(b1)*sin(q2)*sin(q3) + 2*dq2^2*l^2*mf*cos(b1)*cos(b2)^2*cos(q3)^2*sin(b1)*sin(q2) - 2*db1*dq1*h*l*mf*cos(b2)*cos(q2)^2*sin(b1) - 2*db2*dq1*h*l*mf*cos(b1)*cos(q2)^2*sin(b2) - 2*dq1*dq3*h*l*mf*cos(b2)*cos(q2)^2*sin(b1) + a*b*dq1*dq2*mp*cos(gama1)*cos(q2)^2*sin(q3) - a*b*dq1*dq2*mp*cos(gama2)*cos(q2)^2*sin(q3) - a*b*dq2*dq3*mp*cos(q2)*cos(q3)^2*sin(gama1) - a*b*dq2*dq3*mp*cos(q2)*cos(q3)^2*sin(gama2) + 2*dq2^2*l^2*mf*cos(b1)^2*cos(b2)^2*cos(q3)*sin(q2)*sin(q3) + dX*db1*l*mf*cos(b1)*cos(b2)*cos(q1)*sin(q3) + dX*db1*l*mf*cos(b2)*cos(q1)*cos(q3)*sin(b1) - dY*db1*l*mf*cos(b1)*cos(q1)*cos(q3)*sin(q2) + 2*db1*dq1*l^2*mf*cos(b1)*cos(b2)^2*cos(q2)^2*sin(b1) + 2*db2*dq1*l^2*mf*cos(b1)^2*cos(b2)*cos(q2)^2*sin(b2) + 2*dq1*dq3*l^2*mf*cos(b1)*cos(b2)^2*cos(q2)^2*sin(b1) + dY*db1*l*mf*cos(b1)*cos(b2)*sin(q1)*sin(q3) + dY*db1*l*mf*cos(b2)*cos(q3)*sin(b1)*sin(q1) + 4*dq1*dq2*h*l*mf*cos(q2)^2*sin(b2)*sin(q3) + 2*db2*dq1*l^2*mf*cos(b2)*cos(q2)^2*cos(q3)^2*sin(b2) + 2*dq1*dq2*l^2*mf*cos(b1)^2*cos(b2)^2*cos(q2)*sin(q2) + dX*db1*l*mf*cos(b1)*cos(q3)*sin(q1)*sin(q2) + (2*b^2*dgama1*dq1*mp*cos(gama1)*cos(q2)^2*cos(q3)^2*sin(gama1))/3 + (2*b^2*dgama2*dq1*mp*cos(gama2)*cos(q2)^2*cos(q3)^2*sin(gama2))/3 - dq2^2*l^2*mf*cos(b1)*cos(b2)*cos(q2)*cos(q3)*sin(b2) + dq3^2*l^2*mf*cos(b1)*cos(b2)*cos(q2)*cos(q3)*sin(b2) + (2*b^2*dq1*dq2*mp*cos(gama1)^2*cos(q2)*cos(q3)^2*sin(q2))/3 + (2*b^2*dq1*dq2*mp*cos(gama2)^2*cos(q2)*cos(q3)^2*sin(q2))/3 + (2*b^2*dq1*dq3*mp*cos(gama1)^2*cos(q2)^2*cos(q3)*sin(q3))/3 + (2*b^2*dq1*dq3*mp*cos(gama2)^2*cos(q2)^2*cos(q3)*sin(q3))/3 + 2*db1*dq1*l^2*mf*cos(b2)^2*cos(q2)^2*cos(q3)*sin(q3) + 2*dq1*dq2*l^2*mf*cos(b2)^2*cos(q2)*cos(q3)^2*sin(q2) + 2*dq1*dq3*l^2*mf*cos(b2)^2*cos(q2)^2*cos(q3)*sin(q3) + dY*db1*l*mf*cos(q1)*sin(b1)*sin(q2)*sin(q3) - dX*db1*l*mf*sin(b1)*sin(q1)*sin(q2)*sin(q3) + dq2^2*l^2*mf*cos(b2)*cos(q2)*sin(b1)*sin(b2)*sin(q3) - dq3^2*l^2*mf*cos(b2)*cos(q2)*sin(b1)*sin(b2)*sin(q3) + (a*b*dgama1*dq1*mp*cos(gama1)*cos(q2)^2*cos(q3)^2)/2 + (a*b*dgama2*dq1*mp*cos(gama2)*cos(q2)^2*cos(q3)^2)/2 + db1*db2*l^2*mf*cos(b1)*cos(b2)*cos(q2)*sin(q3) + db1*db2*l^2*mf*cos(b2)*cos(q2)*cos(q3)*sin(b1) + db1*dq3*l^2*mf*cos(b1)*cos(q2)*cos(q3)*sin(b2) + 2*dq1*dq2*l^2*mf*cos(b1)*cos(b2)*sin(b2)*sin(q3) + 2*dq1*dq2*l^2*mf*cos(b2)*cos(q3)*sin(b1)*sin(b2) - 4*db1*dq2*l^2*mf*cos(b1)^2*cos(b2)^2*cos(q2)*cos(q3)^2 - 4*dq2*dq3*l^2*mf*cos(b1)^2*cos(b2)^2*cos(q2)*cos(q3)^2 - (b^2*dgama1*dq1*mp*cos(gama1)*cos(q2)*sin(q2)*sin(q3))/2 + (b^2*dgama2*dq1*mp*cos(gama2)*cos(q2)*sin(q2)*sin(q3))/2 - (b^2*dq1*dq3*mp*cos(q2)*cos(q3)*sin(gama1)*sin(q2))/2 + (b^2*dq1*dq3*mp*cos(q2)*cos(q3)*sin(gama2)*sin(q2))/2 + 2*db2*dq1*l^2*mf*cos(b1)*cos(q2)*sin(q2)*sin(q3) + 2*db2*dq1*l^2*mf*cos(q2)*cos(q3)*sin(b1)*sin(q2) - db1*dq2*l^2*mf*cos(b1)*sin(b2)*sin(q2)*sin(q3) - db1*dq2*l^2*mf*cos(q3)*sin(b1)*sin(b2)*sin(q2) - db1*dq3*l^2*mf*cos(q2)*sin(b1)*sin(b2)*sin(q3) - db1*dq2*h*l*mf*cos(b1)*cos(b2)*cos(q2) + (a*b*dq2^2*mp*cos(q3)*sin(gama1)*sin(q2)*sin(q3))/2 + (a*b*dq2^2*mp*cos(q3)*sin(gama2)*sin(q2)*sin(q3))/2 + 2*db2*dq2*h*l*mf*cos(b2)*cos(q3)*sin(q2) - db1*db2*h*l*mf*cos(b1)*sin(b2)*sin(q2) - 2*db1*dq3*h*l*mf*cos(b2)*sin(b1)*sin(q2) - 2*db2*dq3*h*l*mf*cos(b1)*sin(b2)*sin(q2) - (a*b*dgama1*dq2*mp*cos(q3)*sin(gama1)*sin(q2))/2 + (a*b*dgama2*dq2*mp*cos(q3)*sin(gama2)*sin(q2))/2 + a*b*dq1*dq2*mp*cos(q2)*sin(gama1)*sin(q2) + a*b*dq1*dq2*mp*cos(q2)*sin(gama2)*sin(q2) + dY*db1*l*mf*cos(b1)*cos(b2)*cos(q1)*cos(q3)*sin(q2) - 2*db2*dq2*h*l*mf*cos(q2)*cos(q3)^2*sin(b1)*sin(b2) - a*b*dq1*dq2*mp*cos(q2)*cos(q3)^2*sin(gama1)*sin(q2) - a*b*dq1*dq2*mp*cos(q2)*cos(q3)^2*sin(gama2)*sin(q2) - a*b*dq1*dq3*mp*cos(q2)^2*cos(q3)*sin(gama1)*sin(q3) - a*b*dq1*dq3*mp*cos(q2)^2*cos(q3)*sin(gama2)*sin(q3) - dX*db1*l*mf*cos(b1)*cos(b2)*cos(q3)*sin(q1)*sin(q2) - dY*db1*l*mf*cos(b2)*cos(q1)*sin(b1)*sin(q2)*sin(q3) + dX*db1*l*mf*cos(b2)*sin(b1)*sin(q1)*sin(q2)*sin(q3) + db1*dq3*l^2*mf*cos(b1)*cos(b2)*cos(q2)*cos(q3)*sin(b2) - 2*db2*dq2*l^2*mf*cos(b1)*cos(b2)*cos(q2)*sin(b1)*sin(b2) + 2*db1*dq1*h*l*mf*cos(b2)*cos(q2)^2*cos(q3)^2*sin(b1) + 2*db2*dq1*h*l*mf*cos(b1)*cos(q2)^2*cos(q3)^2*sin(b2) + 4*dq1*dq3*h*l*mf*cos(b2)*cos(q2)^2*cos(q3)^2*sin(b1) - 4*db1*dq1*l^2*mf*cos(b1)*cos(b2)^2*cos(q2)^2*cos(q3)^2*sin(b1) - 4*db2*dq1*l^2*mf*cos(b1)^2*cos(b2)*cos(q2)^2*cos(q3)^2*sin(b2) - 4*dq1*dq3*l^2*mf*cos(b1)*cos(b2)^2*cos(q2)^2*cos(q3)^2*sin(b1) - 2*db2*dq2*l^2*mf*cos(b2)*cos(q2)*cos(q3)*sin(b2)*sin(q3) - (2*b^2*dgama1*dq2*mp*cos(gama1)*cos(q2)*cos(q3)*sin(gama1)*sin(q3))/3 - (2*b^2*dgama2*dq2*mp*cos(gama2)*cos(q2)*cos(q3)*sin(gama2)*sin(q3))/3 + (2*b^2*dq1*dq3*mp*cos(gama1)*cos(q2)*cos(q3)*sin(gama1)*sin(q2))/3 - (2*b^2*dq1*dq3*mp*cos(gama2)*cos(q2)*cos(q3)*sin(gama2)*sin(q2))/3 + db1*dq2*l^2*mf*cos(b1)*cos(b2)*sin(b2)*sin(q2)*sin(q3) + db1*dq2*l^2*mf*cos(b2)*cos(q3)*sin(b1)*sin(b2)*sin(q2) - db1*dq3*l^2*mf*cos(b2)*cos(q2)*sin(b1)*sin(b2)*sin(q3) - 2*dq2^2*h*l*mf*cos(b1)*cos(b2)*cos(q3)*sin(q2)*sin(q3) - 4*db1*dq1*l^2*mf*cos(b1)^2*cos(b2)^2*cos(q2)^2*cos(q3)*sin(q3) - 4*dq1*dq2*l^2*mf*cos(b1)^2*cos(b2)^2*cos(q2)*cos(q3)^2*sin(q2) - 4*dq1*dq3*l^2*mf*cos(b1)^2*cos(b2)^2*cos(q2)^2*cos(q3)*sin(q3) - 4*dq1*dq2*h*l*mf*cos(b1)*cos(b2)*cos(q2)*sin(q2) - (a*b*dgama1*dq2*mp*cos(gama1)*cos(q2)*cos(q3)*sin(q3))/2 - (a*b*dgama2*dq2*mp*cos(gama2)*cos(q2)*cos(q3)*sin(q3))/2 + (a*b*dq1*dq3*mp*cos(gama1)*cos(q2)*cos(q3)*sin(q2))/2 - (a*b*dq1*dq3*mp*cos(gama2)*cos(q2)*cos(q3)*sin(q2))/2 + 2*db2*dq1*h*l*mf*cos(b2)*cos(q2)*sin(q2)*sin(q3) + 2*dq1*dq3*h*l*mf*cos(q2)*cos(q3)*sin(b2)*sin(q2) - (a*b*dgama1*dq1*mp*cos(q2)*sin(gama1)*sin(q2)*sin(q3))/2 + (a*b*dgama2*dq1*mp*cos(q2)*sin(gama2)*sin(q2)*sin(q3))/2 - 4*dq1*dq2*l^2*mf*cos(b1)*cos(b2)*cos(q2)^2*sin(b2)*sin(q3) - 4*dq1*dq2*l^2*mf*cos(b2)*cos(q2)^2*cos(q3)*sin(b1)*sin(b2) - 4*db2*dq1*l^2*mf*cos(b1)*cos(b2)^2*cos(q2)*sin(q2)*sin(q3) - 4*db2*dq1*l^2*mf*cos(b2)^2*cos(q2)*cos(q3)*sin(b1)*sin(q2) + 2*db1*dq2*h*l*mf*cos(b1)*cos(b2)*cos(q2)*cos(q3)^2 + 4*dq2*dq3*h*l*mf*cos(b1)*cos(b2)*cos(q2)*cos(q3)^2 - 2*db2*dq1*h*l*mf*cos(q2)^2*cos(q3)*sin(b1)*sin(b2)*sin(q3) - 2*db1*dq1*l^2*mf*cos(b1)*cos(b2)*cos(q2)*cos(q3)*sin(b2)*sin(q2) - 2*dq1*dq3*l^2*mf*cos(b1)*cos(b2)*cos(q2)*cos(q3)*sin(b2)*sin(q2) + 2*db1*dq1*l^2*mf*cos(b2)*cos(q2)*sin(b1)*sin(b2)*sin(q2)*sin(q3) + 2*dq1*dq3*l^2*mf*cos(b2)*cos(q2)*sin(b1)*sin(b2)*sin(q2)*sin(q3) - 2*db1*dq2*h*l*mf*cos(b2)*cos(q2)*cos(q3)*sin(b1)*sin(q3) - 2*db2*dq2*h*l*mf*cos(b1)*cos(q2)*cos(q3)*sin(b2)*sin(q3) - 4*dq2*dq3*h*l*mf*cos(b2)*cos(q2)*cos(q3)*sin(b1)*sin(q3) + 4*db2*dq2*l^2*mf*cos(b1)*cos(b2)*cos(q2)*cos(q3)^2*sin(b1)*sin(b2) + 4*db1*dq2*l^2*mf*cos(b1)*cos(b2)^2*cos(q2)*cos(q3)*sin(b1)*sin(q3) + 4*db2*dq2*l^2*mf*cos(b1)^2*cos(b2)*cos(q2)*cos(q3)*sin(b2)*sin(q3) + 4*dq2*dq3*l^2*mf*cos(b1)*cos(b2)^2*cos(q2)*cos(q3)*sin(b1)*sin(q3) + 2*db1*dq1*h*l*mf*cos(b1)*cos(b2)*cos(q2)^2*cos(q3)*sin(q3) + 4*dq1*dq2*h*l*mf*cos(b1)*cos(b2)*cos(q2)*cos(q3)^2*sin(q2) + 4*dq1*dq3*h*l*mf*cos(b1)*cos(b2)*cos(q2)^2*cos(q3)*sin(q3) - 4*dq1*dq2*h*l*mf*cos(b2)*cos(q2)*cos(q3)*sin(b1)*sin(q2)*sin(q3) + 4*db2*dq1*l^2*mf*cos(b1)*cos(b2)*cos(q2)^2*cos(q3)*sin(b1)*sin(b2)*sin(q3) + 4*dq1*dq2*l^2*mf*cos(b1)*cos(b2)^2*cos(q2)*cos(q3)*sin(b1)*sin(q2)*sin(q3);
B5 =Ixz*dq3^2*cos(q3) + Ixy*dq3^2*sin(q3) - (Ixx*dq1^2*sin(2*q2))/2 + (Iyy*dq1^2*sin(2*q2))/4 + (Izz*dq1^2*sin(2*q2))/4 + Ixx*dq1*dq3*cos(q2) - Ixz*dq1^2*cos(2*q2)*cos(q3) - Ixy*dq1^2*cos(2*q2)*sin(q3) - (a^2*dq1^2*mp*sin(2*q2))/8 + (b^2*dq1^2*mp*sin(2*q2))/3 - (c^2*dq1^2*mp*sin(2*q2))/24 - (dq1^2*h^2*mf*sin(2*q2))/4 + (dq1^2*l^2*mf*sin(2*q2))/8 + 2*Iyz*dq2*dq3*cos(2*q3) - Iyy*dq2*dq3*sin(2*q3) + Izz*dq2*dq3*sin(2*q3) - (Iyy*dq1^2*cos(2*q3)*sin(2*q2))/4 + (Izz*dq1^2*cos(2*q3)*sin(2*q2))/4 - (Iyz*dq1^2*sin(2*q2)*sin(2*q3))/2 - (b^2*dgama1^2*mp*sin(gama1)*sin(q3))/4 + (b^2*dgama2^2*mp*sin(gama2)*sin(q3))/4 - (b^2*dq3^2*mp*sin(gama1)*sin(q3))/4 + (b^2*dq3^2*mp*sin(gama2)*sin(q3))/4 + (a^2*dq1*dq3*mp*cos(q2))/2 - 2*Ixz*dq1*dq3*cos(q3)*sin(q2) - (b^2*dgama1*dq3*mp*cos(q3))/3 + (b^2*dgama2*dq3*mp*cos(q3))/3 + (b^2*dq1*dq3*mp*cos(q2))/3 + (c^2*dq1*dq3*mp*cos(q2))/6 + dq1*dq3*h^2*mf*cos(q2) + (b^2*dgama1*dq2*mp*sin(gama1))/2 + (b^2*dgama2*dq2*mp*sin(gama2))/2 + (dq1*dq3*l^2*mf*cos(q2))/2 - 2*Ixy*dq1*dq3*sin(q2)*sin(q3) - (b^2*dq1^2*mp*sin(2*q2)*cos(gama1))/4 - (b^2*dq1^2*mp*sin(2*q2)*cos(gama2))/4 + (b^2*dq3^2*mp*sin(2*gama1)*sin(q3))/6 - (b^2*dq3^2*mp*sin(2*gama2)*sin(q3))/6 + Iyy*dq1*dq3*cos(2*q3)*cos(q2) - Izz*dq1*dq3*cos(2*q3)*cos(q2) + 2*Iyz*dq1*dq3*sin(2*q3)*cos(q2) - (b^2*dgama1*dq2*mp*sin(2*gama1))/6 - (b^2*dgama2*dq2*mp*sin(2*gama2))/6 + (db2*dq2*l^2*mf*sin(2*b2))/2 + (a^2*dq2*dq3*mp*sin(2*q3))/2 + (b^2*dq2*dq3*mp*sin(2*q3))/3 - (c^2*dq2*dq3*mp*sin(2*q3))/6 + dq2*dq3*h^2*mf*sin(2*q3) + (b^2*dq1^2*mp*cos(2*gama1)*sin(2*q2))/8 + (b^2*dq1^2*mp*cos(2*gama2)*sin(2*q2))/8 - (3*dq1^2*l^2*mf*cos(2*b2)*sin(2*q2))/8 + (a^2*dq1^2*mp*cos(2*q3)*sin(2*q2))/8 + (b^2*dq1^2*mp*cos(2*q3)*sin(2*q2))/12 - (c^2*dq1^2*mp*cos(2*q3)*sin(2*q2))/24 + (dq1^2*h^2*mf*cos(2*q3)*sin(2*q2))/4 - (a*b*dgama1^2*mp*cos(gama1)*sin(q3))/4 + (a*b*dgama2^2*mp*cos(gama2)*sin(q3))/4 + (a*b*dq3^2*mp*cos(gama1)*sin(q3))/4 - (a*b*dq3^2*mp*cos(gama2)*sin(q3))/4 + (b^2*dgama1*dq1*mp*cos(q3)*sin(q2))/3 - (b^2*dgama2*dq1*mp*cos(q3)*sin(q2))/3 - (dq1^2*l^2*mf*sin(2*b1)*sin(2*q2)*sin(2*q3))/8 + db1*db2*l^2*mf*sin(b1)*sin(q3) + db2*dq3*l^2*mf*sin(b1)*sin(q3) - db2^2*h*l*mf*sin(b2)*sin(q3) + dq3^2*h*l*mf*sin(b2)*sin(q3) + (a*b*dgama1*dq2*mp*cos(gama1))/4 + (a*b*dgama2*dq2*mp*cos(gama2))/4 - (dq3^2*l^2*mf*sin(2*b2)*cos(b1)*sin(q3))/2 - (dq3^2*l^2*mf*sin(2*b2)*cos(q3)*sin(b1))/2 + (b^2*dq1^2*mp*cos(2*q2)*sin(gama1)*sin(q3))/4 - (b^2*dq1^2*mp*cos(2*q2)*sin(gama2)*sin(q3))/4 - (b^2*dgama1*dq3*mp*cos(2*gama1)*cos(q3))/3 + (b^2*dgama2*dq3*mp*cos(2*gama2)*cos(q3))/3 - (b^2*dq1*dq3*mp*cos(2*gama1)*cos(q2))/6 - (b^2*dq1*dq3*mp*cos(2*gama2)*cos(q2))/6 + (dq1*dq3*l^2*mf*cos(2*b2)*cos(q2))/2 - (a^2*dq1*dq3*mp*cos(2*q3)*cos(q2))/2 - (b^2*dq1*dq3*mp*cos(2*q3)*cos(q2))/3 + (c^2*dq1*dq3*mp*cos(2*q3)*cos(q2))/6 - dq1*dq3*h^2*mf*cos(2*q3)*cos(q2) - (a*b*dq1^2*mp*sin(2*q2)*sin(gama1))/8 - (a*b*dq1^2*mp*sin(2*q2)*sin(gama2))/8 - (b^2*dq1^2*mp*cos(2*q2)*sin(2*gama1)*sin(q3))/6 + (b^2*dq1^2*mp*cos(2*q2)*sin(2*gama2)*sin(q3))/6 - (b^2*dgama1*dq2*mp*cos(2*q3)*sin(2*gama1))/6 - (b^2*dgama2*dq2*mp*cos(2*q3)*sin(2*gama2))/6 - (b^2*dq2*dq3*mp*cos(2*gama1)*sin(2*q3))/6 - (b^2*dq2*dq3*mp*cos(2*gama2)*sin(2*q3))/6 + (db1*dq2*l^2*mf*cos(2*b1)*sin(2*q3))/2 + (db1*dq2*l^2*mf*cos(2*q3)*sin(2*b1))/2 + (dq2*dq3*l^2*mf*cos(2*b1)*sin(2*q3))/2 + (dq2*dq3*l^2*mf*cos(2*q3)*sin(2*b1))/2 - db1^2*l^2*mf*cos(b1)*sin(b2)*sin(q3) - db1^2*l^2*mf*cos(q3)*sin(b1)*sin(b2) - (b^2*dq1^2*mp*cos(2*gama1)*cos(2*q3)*sin(2*q2))/24 - (b^2*dq1^2*mp*cos(2*gama2)*cos(2*q3)*sin(2*q2))/24 + (b^2*dgama1*dq3*mp*cos(gama1)*cos(q3))/2 - (b^2*dgama2*dq3*mp*cos(gama2)*cos(q3))/2 + (dq1^2*l^2*mf*cos(2*b1)*cos(2*q3)*sin(2*q2))/8 - db1*db2*l^2*mf*cos(b1)*cos(q3) + db1*dq1*l^2*mf*cos(b2)*cos(q2) - db2*dq3*l^2*mf*cos(b1)*cos(q3) - db1*dq1*h*l*mf*cos(b1)*cos(q2) + db1*dq2*h*l*mf*cos(b2)*sin(b1) + db2*dq2*h*l*mf*cos(b1)*sin(b2) + (a*b*dq1*dq3*mp*cos(q2)*sin(gama1))/2 + (a*b*dq1*dq3*mp*cos(q2)*sin(gama2))/2 - (db2*dq2*l^2*mf*sin(2*b1)*sin(2*b2)*sin(2*q3))/2 + (dq1^2*l^2*mf*cos(2*b1)*cos(2*b2)*cos(2*q3)*sin(2*q2))/8 + db2*dq3*l^2*mf*cos(2*b2)*cos(b1)*cos(q3) + (dq1^2*h*l*mf*sin(2*q2)*cos(b1)*cos(b2))/2 - (a*b*dq1^2*mp*cos(2*q2)*cos(gama1)*sin(q3))/4 + (a*b*dq1^2*mp*cos(2*q2)*cos(gama2)*sin(q3))/4 + (b^2*dgama1*dq1*mp*cos(2*gama1)*cos(q3)*sin(q2))/3 - (b^2*dgama2*dq1*mp*cos(2*gama2)*cos(q3)*sin(q2))/3 - (dq1^2*l^2*mf*cos(2*b2)*sin(2*b1)*sin(2*q2)*sin(2*q3))/8 - (db1*dq3*l^2*mf*sin(2*b2)*cos(b1)*sin(q3))/2 - (db1*dq3*l^2*mf*sin(2*b2)*cos(q3)*sin(b1))/2 - db2*dq3*l^2*mf*cos(2*b2)*sin(b1)*sin(q3) - dq1^2*h*l*mf*cos(2*q2)*sin(b2)*sin(q3) - (a*b*dgama1*dq2*mp*cos(2*q3)*cos(gama1))/4 - (a*b*dgama2*dq2*mp*cos(2*q3)*cos(gama2))/4 - (b^2*dq1*dq3*mp*sin(2*gama1)*sin(q2)*sin(q3))/3 + (b^2*dq1*dq3*mp*sin(2*gama2)*sin(q2)*sin(q3))/3 + (dq1^2*l^2*mf*cos(2*q2)*sin(2*b2)*cos(b1)*sin(q3))/2 + (dq1^2*l^2*mf*cos(2*q2)*sin(2*b2)*cos(q3)*sin(b1))/2 + (a*b*dq2*dq3*mp*sin(2*q3)*sin(gama1))/2 + (a*b*dq2*dq3*mp*sin(2*q3)*sin(gama2))/2 + dZ*db1*l*mf*cos(b1)*cos(q3)*sin(q2) + (b^2*dq1*dq3*mp*cos(2*gama1)*cos(2*q3)*cos(q2))/6 + (b^2*dq1*dq3*mp*cos(2*gama2)*cos(2*q3)*cos(q2))/6 - (db1*dq1*l^2*mf*cos(2*b1)*cos(2*q3)*cos(q2))/2 - (dq1*dq3*l^2*mf*cos(2*b1)*cos(2*q3)*cos(q2))/2 - dZ*db1*l*mf*sin(b1)*sin(q2)*sin(q3) + (a*b*dq1^2*mp*cos(2*q3)*sin(2*q2)*sin(gama1))/8 + (a*b*dq1^2*mp*cos(2*q3)*sin(2*q2)*sin(gama2))/8 - (b^2*dgama1*dq1*mp*sin(2*gama1)*sin(2*q3)*cos(q2))/6 - (b^2*dgama2*dq1*mp*sin(2*gama2)*sin(2*q3)*cos(q2))/6 + (db1*dq1*l^2*mf*sin(2*b1)*sin(2*q3)*cos(q2))/2 + (dq1*dq3*l^2*mf*sin(2*b1)*sin(2*q3)*cos(q2))/2 + db1*db2*l^2*mf*cos(b1)*cos(b2)*cos(q3) - (b^2*dgama1*dq1*mp*cos(gama1)*cos(q3)*sin(q2))/2 + (b^2*dgama2*dq1*mp*cos(gama2)*cos(q3)*sin(q2))/2 + db2*dq1*l^2*mf*cos(b1)*cos(q3)*sin(q2) - db1*db2*l^2*mf*cos(b2)*sin(b1)*sin(q3) - db1*dq3*l^2*mf*cos(b1)*sin(b2)*sin(q3) - db1*dq3*l^2*mf*cos(q3)*sin(b1)*sin(b2) + (db1*dq2*l^2*mf*cos(2*b1)*cos(2*b2)*sin(2*q3))/2 + (db1*dq2*l^2*mf*cos(2*b2)*cos(2*q3)*sin(2*b1))/2 + (db2*dq2*l^2*mf*cos(2*b1)*cos(2*q3)*sin(2*b2))/2 + (dq2*dq3*l^2*mf*cos(2*b1)*cos(2*b2)*sin(2*q3))/2 + (dq2*dq3*l^2*mf*cos(2*b2)*cos(2*q3)*sin(2*b1))/2 + (b^2*dq1*dq3*mp*sin(gama1)*sin(q2)*sin(q3))/2 - (b^2*dq1*dq3*mp*sin(gama2)*sin(q2)*sin(q3))/2 - db2*dq1*l^2*mf*sin(b1)*sin(q2)*sin(q3) - db2*dq1*l^2*mf*cos(2*b2)*cos(b1)*cos(q3)*sin(q2) - 2*dq1*dq3*h*l*mf*sin(b2)*sin(q2)*sin(q3) + (db1*dq1*l^2*mf*sin(2*b2)*cos(b1)*sin(q2)*sin(q3))/2 + (db1*dq1*l^2*mf*sin(2*b2)*cos(q3)*sin(b1)*sin(q2))/2 + db2*dq1*l^2*mf*cos(2*b2)*sin(b1)*sin(q2)*sin(q3) + dq1*dq3*l^2*mf*sin(2*b2)*cos(b1)*sin(q2)*sin(q3) + dq1*dq3*l^2*mf*sin(2*b2)*cos(q3)*sin(b1)*sin(q2) - db1*dq2*h*l*mf*cos(2*q3)*cos(b2)*sin(b1) - db1*dq2*h*l*mf*sin(2*q3)*cos(b1)*cos(b2) - db2*dq2*h*l*mf*cos(2*q3)*cos(b1)*sin(b2) - 2*dq2*dq3*h*l*mf*cos(2*q3)*cos(b2)*sin(b1) - 2*dq2*dq3*h*l*mf*sin(2*q3)*cos(b1)*cos(b2) - (a*b*dgama1*dq1*mp*sin(2*q3)*cos(gama1)*cos(q2))/4 - (a*b*dgama2*dq1*mp*sin(2*q3)*cos(gama2)*cos(q2))/4 - (a*b*dq1*dq3*mp*cos(2*q3)*cos(q2)*sin(gama1))/2 - (a*b*dq1*dq3*mp*cos(2*q3)*cos(q2)*sin(gama2))/2 - dX*db1*l*mf*cos(b1)*cos(q1)*cos(q2)*cos(q3) - dZ*db1*l*mf*cos(b1)*cos(b2)*cos(q3)*sin(q2) - dY*db1*l*mf*cos(b1)*cos(q2)*cos(q3)*sin(q1) + db2*dq2*h*l*mf*sin(2*q3)*sin(b1)*sin(b2) + dX*db1*l*mf*cos(q1)*cos(q2)*sin(b1)*sin(q3) + dZ*db1*l*mf*cos(b2)*sin(b1)*sin(q2)*sin(q3) - (dq1^2*h*l*mf*cos(2*q3)*sin(2*q2)*cos(b1)*cos(b2))/2 + dY*db1*l*mf*cos(q2)*sin(b1)*sin(q1)*sin(q3) + (dq1^2*h*l*mf*sin(2*q2)*sin(2*q3)*cos(b2)*sin(b1))/2 - (db1*dq1*l^2*mf*cos(2*b1)*cos(2*b2)*cos(2*q3)*cos(q2))/2 - (dq1*dq3*l^2*mf*cos(2*b1)*cos(2*b2)*cos(2*q3)*cos(q2))/2 + db1*dq1*l^2*mf*cos(b1)*sin(b2)*sin(q2)*sin(q3) + db1*dq1*l^2*mf*cos(q3)*sin(b1)*sin(b2)*sin(q2) - 2*dq1*dq3*h*l*mf*cos(b1)*cos(b2)*cos(q2) + (db1*dq1*l^2*mf*cos(2*b2)*sin(2*b1)*sin(2*q3)*cos(q2))/2 + (db2*dq1*l^2*mf*cos(2*b1)*sin(2*b2)*sin(2*q3)*cos(q2))/2 + (db2*dq1*l^2*mf*cos(2*q3)*sin(2*b1)*sin(2*b2)*cos(q2))/2 + (dq1*dq3*l^2*mf*cos(2*b2)*sin(2*b1)*sin(2*q3)*cos(q2))/2 + db2*dq1*h*l*mf*cos(q2)*sin(b1)*sin(b2) - (a*b*dq1*dq3*mp*cos(gama1)*sin(q2)*sin(q3))/2 + (a*b*dq1*dq3*mp*cos(gama2)*sin(q2)*sin(q3))/2 + dX*db1*l*mf*cos(b1)*cos(b2)*cos(q1)*cos(q2)*cos(q3) + dY*db1*l*mf*cos(b1)*cos(b2)*cos(q2)*cos(q3)*sin(q1) - db1*dq1*h*l*mf*sin(2*q3)*cos(b2)*cos(q2)*sin(b1) - db2*dq1*h*l*mf*cos(2*q3)*cos(q2)*sin(b1)*sin(b2) - db2*dq1*h*l*mf*sin(2*q3)*cos(b1)*cos(q2)*sin(b2) - 2*dq1*dq3*h*l*mf*sin(2*q3)*cos(b2)*cos(q2)*sin(b1) - dX*db1*l*mf*cos(b2)*cos(q1)*cos(q2)*sin(b1)*sin(q3) - dY*db1*l*mf*cos(b2)*cos(q2)*sin(b1)*sin(q1)*sin(q3) + db1*dq1*h*l*mf*cos(2*q3)*cos(b1)*cos(b2)*cos(q2) + 2*dq1*dq3*h*l*mf*cos(2*q3)*cos(b1)*cos(b2)*cos(q2);
B6 =Iyz*dq2^2 - Iyz*dq1^2*cos(q2)^2 - 2*Iyz*dq2^2*cos(q3)^2 + (Iyy*dq2^2*sin(2*q3))/2 - (Izz*dq2^2*sin(2*q3))/2 - Ixx*dq1*dq2*cos(q2) + Iyy*dq1*dq2*cos(q2) - Izz*dq1*dq2*cos(q2) - (a^2*dq2^2*mp*sin(2*q3))/4 - (b^2*dq2^2*mp*sin(2*q3))/3 + (c^2*dq2^2*mp*sin(2*q3))/12 - (dq2^2*h^2*mf*sin(2*q3))/2 + 2*Iyz*dq1^2*cos(q2)^2*cos(q3)^2 + Ixz*dq1^2*cos(q2)*sin(q2)*sin(q3) - a^2*dq1*dq2*mp*cos(q2) + 2*Ixz*dq1*dq2*cos(q3)*sin(q2) + (2*b^2*dgama1*dq2*mp*cos(q3))/3 - (2*b^2*dgama2*dq2*mp*cos(q3))/3 - (4*b^2*dq1*dq2*mp*cos(q2))/3 - 2*dq1*dq2*h^2*mf*cos(q2) - db1*db2*l^2*mf*sin(b2) + db1^2*h*l*mf*sin(b1) + 2*Ixy*dq1*dq2*sin(q2)*sin(q3) - Iyy*dq1^2*cos(q2)^2*cos(q3)*sin(q3) + Izz*dq1^2*cos(q2)^2*cos(q3)*sin(q3) - 2*Iyy*dq1*dq2*cos(q2)*cos(q3)^2 + 2*Izz*dq1*dq2*cos(q2)*cos(q3)^2 + (b^2*dgama1*dq3*mp*sin(2*gama1))/3 + (b^2*dgama2*dq3*mp*sin(2*gama2))/3 - db2*dq3*l^2*mf*sin(2*b2) - Ixy*dq1^2*cos(q2)*cos(q3)*sin(q2) + (2*b^2*dgama1*dq1*mp*cos(q2)*sin(q3))/3 - (2*b^2*dgama2*dq1*mp*cos(q2)*sin(q3))/3 + dq2^2*l^2*mf*cos(b1)*cos(b2)^2*sin(b1) + (a*b*dgama1*dq3*mp*cos(gama1))/2 + (a*b*dgama2*dq3*mp*cos(gama2))/2 + (b^2*dq2^2*mp*cos(gama1)^2*cos(q3)*sin(q3))/3 + (b^2*dq2^2*mp*cos(gama2)^2*cos(q3)*sin(q3))/3 + dq2^2*l^2*mf*cos(b2)^2*cos(q3)*sin(q3) + (a^2*dq1^2*mp*cos(q2)^2*cos(q3)*sin(q3))/2 + (2*b^2*dq1^2*mp*cos(q2)^2*cos(q3)*sin(q3))/3 - (c^2*dq1^2*mp*cos(q2)^2*cos(q3)*sin(q3))/6 + dq1^2*h^2*mf*cos(q2)^2*cos(q3)*sin(q3) - (2*b^2*dgama1*dq2*mp*cos(gama1)^2*cos(q3))/3 + (2*b^2*dgama2*dq2*mp*cos(gama2)^2*cos(q3))/3 + (2*b^2*dq1*dq2*mp*cos(gama1)^2*cos(q2))/3 + (2*b^2*dq1*dq2*mp*cos(gama2)^2*cos(q2))/3 + a^2*dq1*dq2*mp*cos(q2)*cos(q3)^2 + (4*b^2*dq1*dq2*mp*cos(q2)*cos(q3)^2)/3 - (c^2*dq1*dq2*mp*cos(q2)*cos(q3)^2)/3 + 2*dq1*dq2*h^2*mf*cos(q2)*cos(q3)^2 - 4*Iyz*dq1*dq2*cos(q2)*cos(q3)*sin(q3) + db2^2*h*l*mf*cos(b2)*sin(b1) - dq2^2*h*l*mf*cos(b2)*sin(b1) - 2*db2*dq2*h*l*mf*cos(b2)*cos(q3) + db1*db2*h*l*mf*cos(b1)*sin(b2) + 2*db1*dq3*h*l*mf*cos(b2)*sin(b1) + 2*db2*dq3*h*l*mf*cos(b1)*sin(b2) - (a*b*dgama1*dq1*mp*cos(gama1)*sin(q2))/2 + (a*b*dgama1*dq2*mp*cos(q3)*sin(gama1))/2 - (a*b*dgama2*dq1*mp*cos(gama2)*sin(q2))/2 - (a*b*dgama2*dq2*mp*cos(q3)*sin(gama2))/2 - a*b*dq1*dq2*mp*cos(q2)*sin(gama1) - a*b*dq1*dq2*mp*cos(q2)*sin(gama2) + 2*db2*dq2*l^2*mf*cos(b1)*cos(b2)^2*cos(q3) + dq1^2*h*l*mf*cos(b2)*cos(q2)^2*sin(b1) + 2*dq2^2*h*l*mf*cos(b2)*cos(q3)^2*sin(b1) - (2*b^2*dgama1*dq1*mp*cos(gama1)^2*cos(q2)*sin(q3))/3 + (2*b^2*dgama2*dq1*mp*cos(gama2)^2*cos(q2)*sin(q3))/3 - 2*db2*dq2*l^2*mf*cos(b2)^2*sin(b1)*sin(q3) - dq1^2*l^2*mf*cos(b1)*cos(b2)^2*cos(q2)^2*sin(b1) - 2*dq2^2*l^2*mf*cos(b1)*cos(b2)^2*cos(q3)^2*sin(b1) - 2*dq2^2*l^2*mf*cos(b1)^2*cos(b2)^2*cos(q3)*sin(q3) - (b^2*dq1^2*mp*cos(gama1)^2*cos(q2)^2*cos(q3)*sin(q3))/3 - (b^2*dq1^2*mp*cos(gama2)^2*cos(q2)^2*cos(q3)*sin(q3))/3 - dq1^2*l^2*mf*cos(b2)^2*cos(q2)^2*cos(q3)*sin(q3) + dY*db1*l*mf*cos(b1)*cos(q1)*cos(q3) - 2*dq1*dq2*l^2*mf*cos(b1)^2*cos(b2)^2*cos(q2) - dX*db1*l*mf*cos(b1)*cos(q3)*sin(q1) + dZ*db1*l*mf*cos(b1)*cos(q2)*sin(q3) + dZ*db1*l*mf*cos(q2)*cos(q3)*sin(b1) - (2*b^2*dq1*dq2*mp*cos(gama1)^2*cos(q2)*cos(q3)^2)/3 - (2*b^2*dq1*dq2*mp*cos(gama2)^2*cos(q2)*cos(q3)^2)/3 - 2*dq1*dq2*l^2*mf*cos(b2)^2*cos(q2)*cos(q3)^2 - dY*db1*l*mf*cos(q1)*sin(b1)*sin(q3) + dX*db1*l*mf*sin(b1)*sin(q1)*sin(q3) + (b^2*dq1^2*mp*cos(q2)*cos(q3)*sin(gama1)*sin(q2))/4 - (b^2*dq1^2*mp*cos(q2)*cos(q3)*sin(gama2)*sin(q2))/4 + db1*dq2*l^2*mf*cos(b1)*sin(b2)*sin(q3) + db1*dq2*l^2*mf*cos(q3)*sin(b1)*sin(b2) + 2*db2*dq1*l^2*mf*cos(b2)*sin(b2)*sin(q2) - (2*b^2*dgama1*dq1*mp*cos(gama1)*sin(gama1)*sin(q2))/3 - (2*b^2*dgama2*dq1*mp*cos(gama2)*sin(gama2)*sin(q2))/3 - (a*b*dq2^2*mp*cos(q3)*sin(gama1)*sin(q3))/2 - (a*b*dq2^2*mp*cos(q3)*sin(gama2)*sin(q3))/2 - (b^2*dq1*dq2*mp*sin(gama1)*sin(q2)*sin(q3))/2 + (b^2*dq1*dq2*mp*sin(gama2)*sin(q2)*sin(q3))/2 + 2*db2*dq1*l^2*mf*cos(b1)*cos(b2)^2*cos(q2)*sin(q3) + 2*db2*dq1*l^2*mf*cos(b2)^2*cos(q2)*cos(q3)*sin(b1) + 2*dq1*dq2*h*l*mf*sin(b2)*sin(q2)*sin(q3) + (a*b*dq1^2*mp*cos(q2)^2*cos(q3)*sin(gama1)*sin(q3))/2 + (a*b*dq1^2*mp*cos(q2)^2*cos(q3)*sin(gama2)*sin(q3))/2 - dY*db1*l*mf*cos(b1)*cos(b2)*cos(q1)*cos(q3) + a*b*dq1*dq2*mp*cos(q2)*cos(q3)^2*sin(gama1) + a*b*dq1*dq2*mp*cos(q2)*cos(q3)^2*sin(gama2) + dX*db1*l*mf*cos(b1)*cos(b2)*cos(q3)*sin(q1) - dZ*db1*l*mf*cos(b1)*cos(b2)*cos(q2)*sin(q3) - dZ*db1*l*mf*cos(b2)*cos(q2)*cos(q3)*sin(b1) + dY*db1*l*mf*cos(b2)*cos(q1)*sin(b1)*sin(q3) + dX*db1*l*mf*cos(b1)*cos(q1)*sin(q2)*sin(q3) + dX*db1*l*mf*cos(q1)*cos(q3)*sin(b1)*sin(q2) - dX*db1*l*mf*cos(b2)*sin(b1)*sin(q1)*sin(q3) - 2*dq1^2*h*l*mf*cos(b2)*cos(q2)^2*cos(q3)^2*sin(b1) + dY*db1*l*mf*cos(b1)*sin(q1)*sin(q2)*sin(q3) + dY*db1*l*mf*cos(q3)*sin(b1)*sin(q1)*sin(q2) + 2*dq1^2*l^2*mf*cos(b1)*cos(b2)^2*cos(q2)^2*cos(q3)^2*sin(b1) - (b^2*dq1^2*mp*cos(gama1)*cos(q2)*cos(q3)*sin(gama1)*sin(q2))/3 + (b^2*dq1^2*mp*cos(gama2)*cos(q2)*cos(q3)*sin(gama2)*sin(q2))/3 + 2*dq1^2*l^2*mf*cos(b1)^2*cos(b2)^2*cos(q2)^2*cos(q3)*sin(q3) - db1*dq1*l^2*mf*cos(b1)*cos(q2)*cos(q3)*sin(b2) - db1*dq2*l^2*mf*cos(b1)*cos(b2)*sin(b2)*sin(q3) - db1*dq2*l^2*mf*cos(b2)*cos(q3)*sin(b1)*sin(b2) + 2*dq2^2*h*l*mf*cos(b1)*cos(b2)*cos(q3)*sin(q3) - (a*b*dq1^2*mp*cos(gama1)*cos(q2)*cos(q3)*sin(q2))/4 + (a*b*dq1^2*mp*cos(gama2)*cos(q2)*cos(q3)*sin(q2))/4 + 4*dq1*dq2*l^2*mf*cos(b1)^2*cos(b2)^2*cos(q2)*cos(q3)^2 + db1*dq1*l^2*mf*cos(q2)*sin(b1)*sin(b2)*sin(q3) + (2*b^2*dq1*dq2*mp*cos(gama1)*sin(gama1)*sin(q2)*sin(q3))/3 - (2*b^2*dq1*dq2*mp*cos(gama2)*sin(gama2)*sin(q2)*sin(q3))/3 - dq1^2*h*l*mf*cos(q2)*cos(q3)*sin(b2)*sin(q2) + 4*dq1*dq2*h*l*mf*cos(b1)*cos(b2)*cos(q2) - 2*db2*dq1*h*l*mf*cos(b2)*cos(q2)*sin(q3) - 2*db1*dq1*h*l*mf*cos(b2)*sin(b1)*sin(q2) - 2*db2*dq1*h*l*mf*cos(b1)*sin(b2)*sin(q2) + (a*b*dgama1*dq1*mp*cos(q2)*sin(gama1)*sin(q3))/2 - (a*b*dgama2*dq1*mp*cos(q2)*sin(gama2)*sin(q3))/2 + (a*b*dq1*dq2*mp*cos(gama1)*sin(q2)*sin(q3))/2 - (a*b*dq1*dq2*mp*cos(gama2)*sin(q2)*sin(q3))/2 - dX*db1*l*mf*cos(b1)*cos(b2)*cos(q1)*sin(q2)*sin(q3) - dX*db1*l*mf*cos(b2)*cos(q1)*cos(q3)*sin(b1)*sin(q2) - dY*db1*l*mf*cos(b1)*cos(b2)*sin(q1)*sin(q2)*sin(q3) - dY*db1*l*mf*cos(b2)*cos(q3)*sin(b1)*sin(q1)*sin(q2) + dq1^2*l^2*mf*cos(b1)*cos(b2)*cos(q2)*cos(q3)*sin(b2)*sin(q2) - dq1^2*l^2*mf*cos(b2)*cos(q2)*sin(b1)*sin(b2)*sin(q2)*sin(q3) + db1*dq1*l^2*mf*cos(b1)*cos(b2)*cos(q2)*cos(q3)*sin(b2) - db1*dq1*l^2*mf*cos(b2)*cos(q2)*sin(b1)*sin(b2)*sin(q3) - 2*dq1*dq2*l^2*mf*cos(b1)*cos(b2)*sin(b2)*sin(q2)*sin(q3) - 2*dq1*dq2*l^2*mf*cos(b2)*cos(q3)*sin(b1)*sin(b2)*sin(q2) - 2*dq1^2*h*l*mf*cos(b1)*cos(b2)*cos(q2)^2*cos(q3)*sin(q3) - 4*dq1*dq2*h*l*mf*cos(b1)*cos(b2)*cos(q2)*cos(q3)^2 + 4*dq1*dq2*h*l*mf*cos(b2)*cos(q2)*cos(q3)*sin(b1)*sin(q3) - 4*dq1*dq2*l^2*mf*cos(b1)*cos(b2)^2*cos(q2)*cos(q3)*sin(b1)*sin(q3);
B7 =gama1*ks - gamas*ks - (b^2*dq2^2*mp*sin(gama1))/4 - (b^2*dq1^2*mp*sin(2*gama1))/6 - (b^2*dq3^2*mp*sin(2*gama1))/6 - (a*b*dq1^2*mp*cos(gama1))/4 - (a*b*dq2^2*mp*cos(gama1))/4 - (a*b*dq3^2*mp*cos(gama1))/4 - (2*b^2*dq2*dq3*mp*cos(q3))/3 - (b^2*dq1^2*mp*cos(q2)^2*sin(gama1))/4 - (2*b^2*dq1*dq3*mp*cos(q2)*sin(q3))/3 + (2*b^2*dq1^2*mp*cos(gama1)*cos(q2)^2*sin(gama1))/3 + (b^2*dq2^2*mp*cos(gama1)*cos(q3)^2*sin(gama1))/3 + (a*b*dq1^2*mp*cos(gama1)*cos(q2)^2)/4 + (a*b*dq2^2*mp*cos(gama1)*cos(q3)^2)/4 + (2*b^2*dq2*dq3*mp*cos(gama1)^2*cos(q3))/3 + (b^2*dq1^2*mp*cos(q2)*sin(q2)*sin(q3))/3 + (a*b*dq1*dq3*mp*cos(gama1)*sin(q2))/2 - (a*b*dq2*dq3*mp*cos(q3)*sin(gama1))/2 - (2*b^2*dq1^2*mp*cos(gama1)^2*cos(q2)*sin(q2)*sin(q3))/3 - (2*b^2*dq1*dq2*mp*cos(gama1)^2*cos(q3)*sin(q2))/3 + (2*b^2*dq1*dq3*mp*cos(gama1)^2*cos(q2)*sin(q3))/3 - (b^2*dq1^2*mp*cos(gama1)*cos(q2)^2*cos(q3)^2*sin(gama1))/3 - (a*b*dq1^2*mp*cos(gama1)*cos(q2)^2*cos(q3)^2)/4 + (b^2*dq1^2*mp*cos(gama1)*cos(q2)*sin(q2)*sin(q3))/4 + (b^2*dq1*dq2*mp*cos(gama1)*cos(q3)*sin(q2))/2 + (2*b^2*dq1*dq3*mp*cos(gama1)*sin(gama1)*sin(q2))/3 + (a*b*dq1^2*mp*cos(q2)*sin(gama1)*sin(q2)*sin(q3))/4 - (a*b*dq1*dq3*mp*cos(q2)*sin(gama1)*sin(q3))/2 + (2*b^2*dq1*dq2*mp*cos(gama1)*cos(q2)*cos(q3)*sin(gama1)*sin(q3))/3 + (a*b*dq1*dq2*mp*cos(gama1)*cos(q2)*cos(q3)*sin(q3))/2;
B8 =gama2*ks - gamas*ks - (b^2*dq2^2*mp*sin(gama2))/4 - (b^2*dq1^2*mp*sin(2*gama2))/6 - (b^2*dq3^2*mp*sin(2*gama2))/6 - (a*b*dq1^2*mp*cos(gama2))/4 - (a*b*dq2^2*mp*cos(gama2))/4 - (a*b*dq3^2*mp*cos(gama2))/4 + (2*b^2*dq2*dq3*mp*cos(q3))/3 - (b^2*dq1^2*mp*cos(q2)^2*sin(gama2))/4 + (2*b^2*dq1*dq3*mp*cos(q2)*sin(q3))/3 + (2*b^2*dq1^2*mp*cos(gama2)*cos(q2)^2*sin(gama2))/3 + (b^2*dq2^2*mp*cos(gama2)*cos(q3)^2*sin(gama2))/3 + (a*b*dq1^2*mp*cos(gama2)*cos(q2)^2)/4 + (a*b*dq2^2*mp*cos(gama2)*cos(q3)^2)/4 - (2*b^2*dq2*dq3*mp*cos(gama2)^2*cos(q3))/3 - (b^2*dq1^2*mp*cos(q2)*sin(q2)*sin(q3))/3 + (a*b*dq1*dq3*mp*cos(gama2)*sin(q2))/2 + (a*b*dq2*dq3*mp*cos(q3)*sin(gama2))/2 + (2*b^2*dq1^2*mp*cos(gama2)^2*cos(q2)*sin(q2)*sin(q3))/3 + (2*b^2*dq1*dq2*mp*cos(gama2)^2*cos(q3)*sin(q2))/3 - (2*b^2*dq1*dq3*mp*cos(gama2)^2*cos(q2)*sin(q3))/3 - (b^2*dq1^2*mp*cos(gama2)*cos(q2)^2*cos(q3)^2*sin(gama2))/3 - (a*b*dq1^2*mp*cos(gama2)*cos(q2)^2*cos(q3)^2)/4 - (b^2*dq1^2*mp*cos(gama2)*cos(q2)*sin(q2)*sin(q3))/4 - (b^2*dq1*dq2*mp*cos(gama2)*cos(q3)*sin(q2))/2 + (2*b^2*dq1*dq3*mp*cos(gama2)*sin(gama2)*sin(q2))/3 - (a*b*dq1^2*mp*cos(q2)*sin(gama2)*sin(q2)*sin(q3))/4 + (a*b*dq1*dq3*mp*cos(q2)*sin(gama2)*sin(q3))/2 + (2*b^2*dq1*dq2*mp*cos(gama2)*cos(q2)*cos(q3)*sin(gama2)*sin(q3))/3 + (a*b*dq1*dq2*mp*cos(gama2)*cos(q2)*cos(q3)*sin(q3))/2;
B9 =-l*mf*(dq1^2*h*cos(b2)*sin(b1) + dq2^2*h*cos(b2)*sin(b1) + dq3^2*h*cos(b2)*sin(b1) + db2*dq3*l*sin(b2) - dq1*dq2*h*cos(b1)*cos(q2) + db2*dq3*h*cos(b1)*sin(b2) - db2*dq2*l*cos(b1)*cos(q3) + dq1*dq2*l*cos(b2)*cos(q2) - db2*dq1*l*sin(b2)*sin(q2) + db2*dq2*l*sin(b1)*sin(q3) - dq2^2*l*cos(b1)*cos(b2)^2*sin(b1) - dq1^2*h*cos(b2)*cos(q2)^2*sin(b1) - dq2^2*h*cos(b2)*cos(q3)^2*sin(b1) - dq2^2*l*cos(b2)^2*cos(q3)*sin(q3) - dq1*dq2*l*cos(b2)^2*cos(q2) + dY*dq3*cos(b1)*cos(q1)*cos(q3) - dX*dq1*cos(b1)*cos(q1)*sin(q3) - dX*dq1*cos(q1)*cos(q3)*sin(b1) - dX*dq3*cos(b1)*cos(q3)*sin(q1) + dZ*dq2*cos(b1)*cos(q3)*sin(q2) + dZ*dq3*cos(b1)*cos(q2)*sin(q3) + dZ*dq3*cos(q2)*cos(q3)*sin(b1) - dY*dq1*cos(b1)*sin(q1)*sin(q3) - dY*dq1*cos(q3)*sin(b1)*sin(q1) - dY*dq3*cos(q1)*sin(b1)*sin(q3) + dX*dq3*sin(b1)*sin(q1)*sin(q3) - dZ*dq2*sin(b1)*sin(q2)*sin(q3) - db2*dq1*h*cos(b1)*sin(b2)*sin(q2) - 2*dq1*dq3*h*cos(b2)*sin(b1)*sin(q2) - db2*dq1*l*cos(b1)*cos(q2)*sin(q3) - db2*dq1*l*cos(q2)*cos(q3)*sin(b1) + db2*dq2*l*cos(b2)*sin(b1)*sin(q3) + dq2*dq3*l*cos(b1)*sin(b2)*sin(q3) + dq2*dq3*l*cos(q3)*sin(b1)*sin(b2) - dY*dq3*cos(b1)*cos(b2)*cos(q1)*cos(q3) - dX*dq2*cos(b1)*cos(q1)*cos(q2)*cos(q3) - dZ*db2*cos(b1)*cos(q2)*cos(q3)*sin(b2) + dX*dq1*cos(b1)*cos(b2)*cos(q1)*sin(q3) + dX*dq1*cos(b2)*cos(q1)*cos(q3)*sin(b1) + dX*dq3*cos(b1)*cos(b2)*cos(q3)*sin(q1) - dZ*dq2*cos(b1)*cos(b2)*cos(q3)*sin(q2) - dZ*dq3*cos(b1)*cos(b2)*cos(q2)*sin(q3) - dZ*dq3*cos(b2)*cos(q2)*cos(q3)*sin(b1) - dY*dq1*cos(b1)*cos(q1)*cos(q3)*sin(q2) - dY*dq2*cos(b1)*cos(q2)*cos(q3)*sin(q1) + dY*db2*cos(b1)*cos(q1)*sin(b2)*sin(q3) + dY*db2*cos(q1)*cos(q3)*sin(b1)*sin(b2) + dY*dq1*cos(b1)*cos(b2)*sin(q1)*sin(q3) + dY*dq1*cos(b2)*cos(q3)*sin(b1)*sin(q1) + dY*dq3*cos(b2)*cos(q1)*sin(b1)*sin(q3) + dq1^2*l*cos(b1)*cos(b2)^2*cos(q2)^2*sin(b1) + 2*dq2^2*l*cos(b1)*cos(b2)^2*cos(q3)^2*sin(b1) + dX*dq1*cos(b1)*cos(q3)*sin(q1)*sin(q2) + dX*dq2*cos(q1)*cos(q2)*sin(b1)*sin(q3) + dX*dq3*cos(b1)*cos(q1)*sin(q2)*sin(q3) + dX*dq3*cos(q1)*cos(q3)*sin(b1)*sin(q2) - dX*db2*cos(b1)*sin(b2)*sin(q1)*sin(q3) - dX*db2*cos(q3)*sin(b1)*sin(b2)*sin(q1) + dZ*db2*cos(q2)*sin(b1)*sin(b2)*sin(q3) - dX*dq3*cos(b2)*sin(b1)*sin(q1)*sin(q3) + dZ*dq2*cos(b2)*sin(b1)*sin(q2)*sin(q3) + dq1^2*h*cos(b2)*cos(q2)^2*cos(q3)^2*sin(b1) + 2*dq2^2*l*cos(b1)^2*cos(b2)^2*cos(q3)*sin(q3) + dY*dq1*cos(q1)*sin(b1)*sin(q2)*sin(q3) + dY*dq2*cos(q2)*sin(b1)*sin(q1)*sin(q3) + dY*dq3*cos(b1)*sin(q1)*sin(q2)*sin(q3) + dY*dq3*cos(q3)*sin(b1)*sin(q1)*sin(q2) + dq1^2*l*cos(b2)^2*cos(q2)^2*cos(q3)*sin(q3) - dX*dq1*sin(b1)*sin(q1)*sin(q2)*sin(q3) + 2*dq1*dq2*l*cos(b1)^2*cos(b2)^2*cos(q2) + 2*dq1*dq2*l*cos(b2)^2*cos(q2)*cos(q3)^2 - dq2^2*h*cos(b1)*cos(b2)*cos(q3)*sin(q3) - dq1*dq2*h*cos(b1)*cos(b2)*cos(q2) - db2*dq2*l*cos(b1)*cos(b2)*cos(q3) + dq1^2*h*cos(b1)*cos(b2)*cos(q2)^2*cos(q3)*sin(q3) + 2*dq1*dq2*h*cos(b1)*cos(b2)*cos(q2)*cos(q3)^2 + dX*dq2*cos(b1)*cos(b2)*cos(q1)*cos(q2)*cos(q3) + dY*dq1*cos(b1)*cos(b2)*cos(q1)*cos(q3)*sin(q2) + dY*dq2*cos(b1)*cos(b2)*cos(q2)*cos(q3)*sin(q1) - dX*db2*cos(b1)*cos(q1)*cos(q3)*sin(b2)*sin(q2) - dX*dq1*cos(b1)*cos(b2)*cos(q3)*sin(q1)*sin(q2) - dX*dq2*cos(b2)*cos(q1)*cos(q2)*sin(b1)*sin(q3) - dX*dq3*cos(b1)*cos(b2)*cos(q1)*sin(q2)*sin(q3) - dX*dq3*cos(b2)*cos(q1)*cos(q3)*sin(b1)*sin(q2) - dY*db2*cos(b1)*cos(q3)*sin(b2)*sin(q1)*sin(q2) - dY*dq1*cos(b2)*cos(q1)*sin(b1)*sin(q2)*sin(q3) - dY*dq2*cos(b2)*cos(q2)*sin(b1)*sin(q1)*sin(q3) - dY*dq3*cos(b1)*cos(b2)*sin(q1)*sin(q2)*sin(q3) - dY*dq3*cos(b2)*cos(q3)*sin(b1)*sin(q1)*sin(q2) + dX*db2*cos(q1)*sin(b1)*sin(b2)*sin(q2)*sin(q3) + dX*dq1*cos(b2)*sin(b1)*sin(q1)*sin(q2)*sin(q3) + dY*db2*sin(b1)*sin(b2)*sin(q1)*sin(q2)*sin(q3) - 2*dq1^2*l*cos(b1)*cos(b2)^2*cos(q2)^2*cos(q3)^2*sin(b1) - 2*dq1^2*l*cos(b1)^2*cos(b2)^2*cos(q2)^2*cos(q3)*sin(q3) - db2*dq1*l*cos(b1)*cos(b2)*cos(q2)*sin(q3) - db2*dq1*l*cos(b2)*cos(q2)*cos(q3)*sin(b1) - dq1*dq3*l*cos(b1)*cos(q2)*cos(q3)*sin(b2) - dq2*dq3*l*cos(b1)*cos(b2)*sin(b2)*sin(q3) - dq2*dq3*l*cos(b2)*cos(q3)*sin(b1)*sin(b2) - 4*dq1*dq2*l*cos(b1)^2*cos(b2)^2*cos(q2)*cos(q3)^2 + dq1*dq2*l*cos(b1)*sin(b2)*sin(q2)*sin(q3) + dq1*dq2*l*cos(q3)*sin(b1)*sin(b2)*sin(q2) + dq1*dq3*l*cos(q2)*sin(b1)*sin(b2)*sin(q3) - dq1^2*l*cos(b1)*cos(b2)*cos(q2)*cos(q3)*sin(b2)*sin(q2) + dq1^2*l*cos(b2)*cos(q2)*sin(b1)*sin(b2)*sin(q2)*sin(q3) + dq1*dq3*l*cos(b1)*cos(b2)*cos(q2)*cos(q3)*sin(b2) - 2*dq1*dq2*h*cos(b2)*cos(q2)*cos(q3)*sin(b1)*sin(q3) + dq1*dq2*l*cos(b1)*cos(b2)*sin(b2)*sin(q2)*sin(q3) + dq1*dq2*l*cos(b2)*cos(q3)*sin(b1)*sin(b2)*sin(q2) - dq1*dq3*l*cos(b2)*cos(q2)*sin(b1)*sin(b2)*sin(q3) + 4*dq1*dq2*l*cos(b1)*cos(b2)^2*cos(q2)*cos(q3)*sin(b1)*sin(q3));
B10=-(l*mf*(2*dq2^2*l*sin(2*b2) - dq1^2*l*sin(2*b2) - 4*dq3^2*l*sin(2*b2) + 6*dq1^2*h*cos(b1)*sin(b2) + 4*dq2^2*h*cos(b1)*sin(b2) + 8*dq3^2*h*cos(b1)*sin(b2) - 8*db1*dq3*l*sin(b2) + 3*dq1^2*l*cos(2*q2)*sin(2*b2) - dq1^2*l*cos(2*b1)*cos(2*q3)*sin(2*b2) + 2*dq2^2*l*cos(2*b1)*cos(2*q3)*sin(2*b2) - 16*dq2*dq3*h*cos(b2)*cos(q3) - 8*db1*dq3*h*cos(b1)*sin(b2) + 8*db1*dq2*l*cos(b1)*cos(q3) + 8*dq2*dq3*l*cos(b1)*cos(q3) + dq1^2*l*sin(2*b1)*sin(2*b2)*sin(2*q3) - 2*dq2^2*l*sin(2*b1)*sin(2*b2)*sin(2*q3) + 8*db1*dq1*l*sin(b2)*sin(q2) - 8*db1*dq2*l*sin(b1)*sin(q3) - 8*dq2*dq3*l*sin(b1)*sin(q3) - 2*dq1^2*h*cos(2*q2)*cos(b1)*sin(b2) + 2*dq1^2*h*cos(2*q3)*cos(b1)*sin(b2) - 4*dq2^2*h*cos(2*q3)*cos(b1)*sin(b2) + 4*dq1^2*h*sin(2*q2)*cos(b2)*sin(q3) - 2*dq1^2*h*sin(2*q3)*sin(b1)*sin(b2) + 4*dq2^2*h*sin(2*q3)*sin(b1)*sin(b2) + 8*dq1*dq3*l*sin(2*b2)*sin(q2) - 16*dq1*dq3*h*cos(b2)*cos(q2)*sin(q3) + 8*db1*dq1*h*cos(b1)*sin(b2)*sin(q2) + 8*dq1*dq2*h*cos(q2)*sin(b1)*sin(b2) - 16*dq1*dq3*h*cos(b1)*sin(b2)*sin(q2) + 8*db1*dq1*l*cos(b1)*cos(q2)*sin(q3) + 8*db1*dq1*l*cos(q2)*cos(q3)*sin(b1) + 8*dq1*dq2*l*cos(b1)*cos(q3)*sin(q2) + 8*dq1*dq3*l*cos(b1)*cos(q2)*sin(q3) + 8*dq1*dq3*l*cos(q2)*cos(q3)*sin(b1) - 8*db1*dq2*l*cos(b2)*sin(b1)*sin(q3) - 8*dq1*dq2*l*sin(b1)*sin(q2)*sin(q3) - dq1^2*l*cos(2*b1)*cos(2*q2)*cos(2*q3)*sin(2*b2) + 8*dq2*dq3*l*cos(2*b2)*cos(b1)*cos(q3) + 8*dZ*db1*cos(b1)*cos(q2)*cos(q3)*sin(b2) + dq1^2*l*cos(2*q2)*sin(2*b1)*sin(2*b2)*sin(2*q3) - 8*dq2*dq3*l*cos(2*b2)*sin(b1)*sin(q3) - 8*dY*db1*cos(b1)*cos(q1)*sin(b2)*sin(q3) - 8*dY*db1*cos(q1)*cos(q3)*sin(b1)*sin(b2) + 8*dX*db1*cos(b1)*sin(b2)*sin(q1)*sin(q3) + 8*dX*db1*cos(q3)*sin(b1)*sin(b2)*sin(q1) - 8*dZ*db1*cos(q2)*sin(b1)*sin(b2)*sin(q3) + 2*dq1^2*h*cos(2*q2)*cos(2*q3)*cos(b1)*sin(b2) - 4*dq1^2*l*cos(2*b2)*sin(2*q2)*cos(b1)*sin(q3) - 4*dq1^2*l*cos(2*b2)*sin(2*q2)*cos(q3)*sin(b1) - 2*dq1^2*h*cos(2*q2)*sin(2*q3)*sin(b1)*sin(b2) + 8*db1*dq2*l*cos(b1)*cos(b2)*cos(q3) + 4*dq1*dq2*l*cos(2*b1)*sin(2*b2)*sin(2*q3)*cos(q2) + 4*dq1*dq2*l*cos(2*q3)*sin(2*b1)*sin(2*b2)*cos(q2) - 8*dq1*dq2*l*cos(2*b2)*cos(b1)*cos(q3)*sin(q2) + 8*dq1*dq3*l*cos(2*b2)*cos(b1)*cos(q2)*sin(q3) + 8*dq1*dq3*l*cos(2*b2)*cos(q2)*cos(q3)*sin(b1) - 8*dq1*dq2*h*cos(2*q3)*cos(q2)*sin(b1)*sin(b2) - 8*dq1*dq2*h*sin(2*q3)*cos(b1)*cos(q2)*sin(b2) + 8*dX*db1*cos(b1)*cos(q1)*cos(q3)*sin(b2)*sin(q2) + 8*dq1*dq2*l*cos(2*b2)*sin(b1)*sin(q2)*sin(q3) + 8*dY*db1*cos(b1)*cos(q3)*sin(b2)*sin(q1)*sin(q2) - 8*dX*db1*cos(q1)*sin(b1)*sin(b2)*sin(q2)*sin(q3) - 8*dY*db1*sin(b1)*sin(b2)*sin(q1)*sin(q2)*sin(q3) + 8*db1*dq1*l*cos(b1)*cos(b2)*cos(q2)*sin(q3) + 8*db1*dq1*l*cos(b2)*cos(q2)*cos(q3)*sin(b1)))/8;


B = [B1 ; B2 ; B3 ; B4 ; B5 ; B6 ; B7 ; B8 ; B9 ; B10];

dQ= -M\B;

dz= [dX ; dY ; dZ ; dq1 ; dq2 ; dq3 ; dgama1 ; dgama2 ; db1 ; db2 ; dQ];